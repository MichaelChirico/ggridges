
R version 4.3.1 (2023-06-16) -- "Beagle Scouts"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(testthat)
> library(HDStIM)
> 
> test_check("HDStIM")
[ FAIL 2 | WARN 0 | SKIP 0 | PASS 3 ]

══ Failed tests ════════════════════════════════════════════════════════════════
── Error ('testHDStIM.R:16:5'): Whether HDStIM maps the same number of cells. ──
Error in `irlba::irlba(L, nv = n, nu = 0, maxit = iters)`: function 'as_cholmod_sparse' not provided by package 'Matrix'
Backtrace:
    ▆
 1. └─HDStIM::HDStIM(...) at testHDStIM.R:16:5
 2.   └─uwot::umap(...)
 3.     └─uwot:::uwot(...)
 4.       └─uwot:::spectral_init(V, ndim = n_components, verbose = verbose)
 5.         └─uwot:::irlba_tsvd_normalized_laplacian_init(A, ndim, verbose = FALSE)
 6.           └─uwot:::irlba_spectral_tsvd(L, ndim + 1)
 7.             ├─base::suppressWarnings(...)
 8.             │ └─base::withCallingHandlers(...)
 9.             └─irlba::irlba(L, nv = n, nu = 0, maxit = iters)
── Error ('testPlots.R:12:3'): If plot_umap returns 0. ─────────────────────────
Error in `irlba::irlba(L, nv = n, nu = 0, maxit = iters)`: function 'as_cholmod_sparse' not provided by package 'Matrix'
Backtrace:
    ▆
 1. └─HDStIM::HDStIM(...) at testPlots.R:12:3
 2.   └─uwot::umap(...)
 3.     └─uwot:::uwot(...)
 4.       └─uwot:::spectral_init(V, ndim = n_components, verbose = verbose)
 5.         └─uwot:::irlba_tsvd_normalized_laplacian_init(A, ndim, verbose = FALSE)
 6.           └─uwot:::irlba_spectral_tsvd(L, ndim + 1)
 7.             ├─base::suppressWarnings(...)
 8.             │ └─base::withCallingHandlers(...)
 9.             └─irlba::irlba(L, nv = n, nu = 0, maxit = iters)

[ FAIL 2 | WARN 0 | SKIP 0 | PASS 3 ]
Error: Test failures
Execution halted
