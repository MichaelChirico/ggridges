
R version 4.3.1 (2023-06-16) -- "Beagle Scouts"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "GeneTonic"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> library('GeneTonic')

> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("GeneTonic")
> ### * GeneTonic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: GeneTonic
> ### Title: GeneTonic
> ### Aliases: GeneTonic
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi

> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> # now everything is in place to launch the app
> if (interactive()) {
+   GeneTonic(
+     dds = dds_macrophage,
+     res_de = res_de,
+     res_enrich = res_enrich,
+     annotation_obj = anno_df,
+     project_id = "myexample"
+   )
+ }
> # alternatively...
> gtl_macrophage <- GeneTonicList(
+   dds = dds_macrophage,
+   res_de = res_de,
+   res_enrich = res_enrich,
+   annotation_obj = anno_df
+ )
---------------------------------
----- GeneTonicList object ------
---------------------------------

----- dds object -----
Providing an expression object (as DESeqDataset) of 58294 features over 24 samples

----- res_de object -----
Providing a DE result object (as DESeqResults), 17806 features tested, 928 found as DE
Upregulated:     599
Downregulated:   329

----- res_enrich object -----
Providing an enrichment result object, 500 reported

----- annotation_obj object -----
Providing an annotation object of 58294 features with information on 2 identifier types

> # GeneTonic(gtl = gtl_macrophage)
> 
> # if running it "as a server", without input data specified:
> if (interactive()) {
+   GeneTonic(size_gtl = 300)   # for fairly large gtl objects
+ }
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("GeneTonicList")
> ### * GeneTonicList
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: GeneTonicList
> ### Title: Create a GeneTonicList object
> ### Aliases: GeneTonicList GeneTonic_list
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gtl_macrophage <- GeneTonicList(
+   dds = dds_macrophage,
+   res_de = res_de,
+   res_enrich = res_enrich,
+   annotation_obj = anno_df
+ )
---------------------------------
----- GeneTonicList object ------
---------------------------------

----- dds object -----
Providing an expression object (as DESeqDataset) of 58294 features over 24 samples

----- res_de object -----
Providing a DE result object (as DESeqResults), 17806 features tested, 928 found as DE
Upregulated:     599
Downregulated:   329

----- res_enrich object -----
Providing an enrichment result object, 500 reported

----- annotation_obj object -----
Providing an annotation object of 58294 features with information on 2 identifier types

> 
> # now everything is in place to launch the app
> if (interactive()) {
+   GeneTonic(gtl = gtl_macrophage)
+ }
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("check_colors")
> ### * check_colors
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: check_colors
> ### Title: Check colors
> ### Aliases: check_colors
> 
> ### ** Examples
> 
> # simple case
> mypal <- c("steelblue", "#FF1100")
> check_colors(mypal)
steelblue   #FF1100 
     TRUE      TRUE 
> mypal2 <- rev(
+   scales::alpha(
+     colorRampPalette(RColorBrewer::brewer.pal(name = "RdYlBu", 11))(50), 0.4
+   )
+ )
> check_colors(mypal2)
#31369566 #35429B66 #394FA166 #3D5CA766 #4169AE66 #4576B466 #4F81BA66 #598DC066 
     TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
#6298C666 #6CA3CC66 #76AED166 #81B7D666 #8CC0DB66 #97C9E066 #A3D2E566 #AEDAE966 
     TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
#B9DFEC66 #C3E5F066 #CEEAF366 #D9EFF666 #E2F3F366 #E8F6E766 #EFF8DC66 #F5FBD066 
     TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
#FBFDC466 #FEFBBA66 #FEF5B066 #FEEFA766 #FEE89D66 #FEE29366 #FDD98A66 #FDCF8066 
     TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
#FDC57766 #FDBB6D66 #FDB16366 #FBA45C66 #F9975666 #F88A5066 #F67C4A66 #F46F4466 
     TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
#EF633E66 #E9563866 #E34A3366 #DD3D2D66 #D7312766 #CD272666 #C31D2666 #B9132666 
     TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
#AF092666 #A5002666 
     TRUE      TRUE 
> # useful with long vectors to check at once if all cols are fine
> all(check_colors(mypal2))
[1] TRUE
> 
> 
> 
> cleanEx()
> nameEx("checkup_GeneTonic")
> ### * checkup_GeneTonic
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: checkup_GeneTonic
> ### Title: Checking the input objects for GeneTonic
> ### Aliases: checkup_GeneTonic
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> checkup_GeneTonic(
+   dds = dds_macrophage,
+   res_de = res_de,
+   res_enrich = res_enrich,
+   annotation_obj = anno_df
+ )
> # if all is fine, it should return an invisible NULL and a simple message
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("checkup_gtl")
> ### * checkup_gtl
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: checkup_gtl
> ### Title: Checking the 'gtl' input object for GeneTonic
> ### Aliases: checkup_gtl
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gtl <- list(
+   dds = dds_macrophage,
+   res_de = res_de,
+   res_enrich = res_enrich,
+   annotation_obj = anno_df
+ )
> 
> checkup_gtl(gtl)
> # if all is fine, it should return an invisible NULL and a simple message
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("cluster_markov")
> ### * cluster_markov
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: cluster_markov
> ### Title: Markov Clustering (MCL) for community detection
> ### Aliases: cluster_markov
> 
> ### ** Examples
> 
> library("igraph")

Attaching package: ‘igraph’

The following objects are masked from ‘package:stats’:

    decompose, spectrum

The following object is masked from ‘package:base’:

    union

> g <- make_full_graph(5) %du% make_full_graph(5) %du% make_full_graph(5)
> g <- add_edges(g, c(1, 6, 1, 11, 6, 11))
> cluster_markov(g)
IGRAPH clustering mcl, groups: 3, mod: NA
+ groups:
  $`1`
  [1] 1 2 3 4 5
  
  $`2`
  [1]  6  7  8  9 10
  
  $`3`
  [1] 11 12 13 14 15
  
> V(g)$color <- cluster_markov(g)$membership
> plot(g)
> 
> 
> 
> cleanEx()

detaching ‘package:igraph’

> nameEx("create_jaccard_matrix")
> ### * create_jaccard_matrix
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: create_jaccard_matrix
> ### Title: Compute the overlap matrix for enrichment results
> ### Aliases: create_jaccard_matrix
> 
> ### ** Examples
> 
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> 
> jmat <- create_jaccard_matrix(res_enrich[1:200, ])
> dim(jmat)
[1] 200 200
> 
> 
> 
> cleanEx()
> nameEx("create_kappa_matrix")
> ### * create_kappa_matrix
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: create_kappa_matrix
> ### Title: Compute the kappa matrix for enrichment results
> ### Aliases: create_kappa_matrix
> 
> ### ** Examples
> 
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> 
> kmat <- create_kappa_matrix(res_enrich[1:200, ])
> dim(kmat)
[1] 200 200
> 
> 
> 
> cleanEx()
> nameEx("create_upsetdata")
> ### * create_upsetdata
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: create_upsetdata
> ### Title: Create a geneset upset dataset
> ### Aliases: create_upsetdata
> 
> ### ** Examples
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> 
> create_upsetdata(res_enrich[1:20, ])
          adaptive immune response interferon-gamma-mediated signaling pathway
B2M                              1                                           1
BCL6                             1                                           0
BTN3A1                           1                                           0
BTN3A2                           1                                           0
BTN3A3                           1                                           0
C1QB                             1                                           0
C1R                              1                                           0
C1RL                             1                                           0
C1S                              1                                           0
C2                               1                                           0
C3                               1                                           0
C4A                              1                                           0
C4B                              1                                           0
CD1A                             1                                           0
CD1C                             1                                           0
CD274                            1                                           0
CD28                             1                                           0
CD40                             1                                           0
CD7                              1                                           0
CD74                             1                                           0
CD80                             1                                           0
CEACAM1                          1                                           0
CLEC10A                          1                                           0
CLEC6A                           1                                           0
CTLA4                            1                                           0
CTSS                             1                                           0
ERAP2                            1                                           0
EXO1                             1                                           0
FGL1                             1                                           0
FGL2                             1                                           0
GCNT3                            1                                           0
GPR183                           1                                           0
HLA-A                            1                                           1
HLA-B                            1                                           1
HLA-C                            1                                           1
HLA-DMA                          1                                           0
HLA-DMB                          1                                           0
HLA-DOA                          1                                           0
HLA-DOB                          1                                           0
HLA-DPA1                         1                                           1
HLA-DPB1                         1                                           1
HLA-DQA1                         1                                           1
HLA-DQB1                         1                                           1
HLA-DQB2                         1                                           1
HLA-DRA                          1                                           1
HLA-DRB1                         1                                           1
HLA-DRB5                         1                                           1
HLA-E                            1                                           1
HLA-F                            1                                           1
HLA-G                            1                                           1
ICAM1                            1                                           1
IL12A                            1                                           0
IL12RB1                          1                                           0
IL18BP                           1                                           0
IL27                             1                                           0
IRF1                             1                                           1
IRF7                             1                                           1
ITK                              1                                           0
JAK2                             1                                           1
JAK3                             1                                           0
KLRK1                            1                                           0
LAG3                             1                                           0
LAMP3                            1                                           0
LILRA1                           1                                           0
LILRB3                           1                                           0
LYN                              1                                           0
MCOLN2                           1                                           0
P2RX7                            1                                           0
PDCD1                            1                                           0
PDCD1LG2                         1                                           0
RELB                             1                                           0
RIPK2                            1                                           0
RNF19B                           1                                           0
RSAD2                            1                                           0
SERPING1                         1                                           0
SIT1                             1                                           0
SLAMF1                           1                                           0
SLAMF6                           1                                           0
SLAMF7                           1                                           0
SLC11A1                          1                                           0
TAP1                             1                                           0
TAP2                             1                                           0
TBX21                            1                                           0
TLR8                             1                                           0
TNFRSF11A                        1                                           0
TNFRSF21                         1                                           0
TNFSF13B                         1                                           0
TNFSF18                          1                                           0
ZC3H12A                          1                                           0
CAMK2D                           0                                           1
CIITA                            0                                           1
GBP1                             0                                           1
GBP2                             0                                           1
MT2A                             0                                           1
NLRC5                            0                                           1
NMI                              0                                           1
OAS2                             0                                           1
PARP14                           0                                           1
PML                              0                                           1
SOCS1                            0                                           1
STAT1                            0                                           1
TRIM22                           0                                           1
TRIM31                           0                                           1
VCAM1                            0                                           1
IFI27                            0                                           0
IFI35                            0                                           0
IFIT2                            0                                           0
IFIT3                            0                                           0
IFITM1                           0                                           0
IFITM2                           0                                           0
IFITM3                           0                                           0
ISG20                            0                                           0
PSMB8                            0                                           0
STAT2                            0                                           0
XAF1                             0                                           0
ZBP1                             0                                           0
TAPBP                            0                                           0
AIM2                             0                                           0
APOBEC3A                         0                                           0
APOBEC3D                         0                                           0
APOBEC3G                         0                                           0
CXCL10                           0                                           0
CXCL9                            0                                           0
DDX60                            0                                           0
DTX3L                            0                                           0
GBP3                             0                                           0
IFI44L                           0                                           0
IFIH1                            0                                           0
IFIT5                            0                                           0
IL15                             0                                           0
PMAIP1                           0                                           0
RTP4                             0                                           0
SERINC5                          0                                           0
TLR7                             0                                           0
TSPAN32                          0                                           0
CCNE2                            0                                           0
CDC45                            0                                           0
CDC6                             0                                           0
CDT1                             0                                           0
MCM10                            0                                           0
MCM2                             0                                           0
MCM4                             0                                           0
MCM5                             0                                           0
MCM6                             0                                           0
MCM7                             0                                           0
ORC1                             0                                           0
POLE2                            0                                           0
TICRR                            0                                           0
ACOD1                            0                                           0
CALCOCO2                         0                                           0
CCL13                            0                                           0
CCL15                            0                                           0
CCL18                            0                                           0
CCL5                             0                                           0
CCL7                             0                                           0
CCL8                             0                                           0
EDN1                             0                                           0
GBP4                             0                                           0
GBP5                             0                                           0
GBP6                             0                                           0
GBP7                             0                                           0
GCH1                             0                                           0
MEFV                             0                                           0
NUB1                             0                                           0
RAB20                            0                                           0
UBD                              0                                           0
ADAM8                            0                                           0
ADGRE5                           0                                           0
ADORA3                           0                                           0
AGT                              0                                           0
AOC3                             0                                           0
APOL2                            0                                           0
APOL3                            0                                           0
APPL2                            0                                           0
CASP4                            0                                           0
CCRL2                            0                                           0
CDH5                             0                                           0
CFB                              0                                           0
CFH                              0                                           0
CR1L                             0                                           0
CRHBP                            0                                           0
CXCL11                           0                                           0
CXCL5                            0                                           0
CXCR3                            0                                           0
CYLD                             0                                           0
CYSLTR1                          0                                           0
GGT5                             0                                           0
GHRL                             0                                           0
GSDMD                            0                                           0
HGF                              0                                           0
IDO1                             0                                           0
IL1RN                            0                                           0
IL22RA2                          0                                           0
KARS1                            0                                           0
KLF4                             0                                           0
LRRK2                            0                                           0
LY75                             0                                           0
MMP25                            0                                           0
MMP9                             0                                           0
NLRP12                           0                                           0
NOD2                             0                                           0
OSM                              0                                           0
POLB                             0                                           0
PTGER4                           0                                           0
SBNO2                            0                                           0
SLAMF8                           0                                           0
STAP1                            0                                           0
SUCNR1                           0                                           0
TGM2                             0                                           0
TICAM2                           0                                           0
TLR10                            0                                           0
TLR5                             0                                           0
TNFAIP6                          0                                           0
BTN2A2                           0                                           0
FYB1                             0                                           0
PDE4B                            0                                           0
PSMB10                           0                                           0
PSMB9                            0                                           0
PSME1                            0                                           0
PSME2                            0                                           0
APOL1                            0                                           0
CD300LF                          0                                           0
COLEC12                          0                                           0
CX3CR1                           0                                           0
FCN1                             0                                           0
GRAMD4                           0                                           0
H2BC21                           0                                           0
ICAM2                            0                                           0
LILRA2                           0                                           0
MSRB1                            0                                           0
MUC1                             0                                           0
NCF1                             0                                           0
OPTN                             0                                           0
PYHIN1                           0                                           0
TIFA                             0                                           0
TRAFD1                           0                                           0
GINS2                            0                                           0
BATF2                            0                                           0
CARD16                           0                                           0
CARD17                           0                                           0
CMPK2                            0                                           0
LITAF                            0                                           0
PADI2                            0                                           0
KIF11                            0                                           0
KIF15                            0                                           0
KIF26A                           0                                           0
          type I interferon signaling pathway
B2M                                         0
BCL6                                        0
BTN3A1                                      0
BTN3A2                                      0
BTN3A3                                      0
C1QB                                        0
C1R                                         0
C1RL                                        0
C1S                                         0
C2                                          0
C3                                          0
C4A                                         0
C4B                                         0
CD1A                                        0
CD1C                                        0
CD274                                       0
CD28                                        0
CD40                                        0
CD7                                         0
CD74                                        0
CD80                                        0
CEACAM1                                     0
CLEC10A                                     0
CLEC6A                                      0
CTLA4                                       0
CTSS                                        0
ERAP2                                       0
EXO1                                        0
FGL1                                        0
FGL2                                        0
GCNT3                                       0
GPR183                                      0
HLA-A                                       1
HLA-B                                       1
HLA-C                                       1
HLA-DMA                                     0
HLA-DMB                                     0
HLA-DOA                                     0
HLA-DOB                                     0
HLA-DPA1                                    0
HLA-DPB1                                    0
HLA-DQA1                                    0
HLA-DQB1                                    0
HLA-DQB2                                    0
HLA-DRA                                     0
HLA-DRB1                                    0
HLA-DRB5                                    0
HLA-E                                       1
HLA-F                                       1
HLA-G                                       1
ICAM1                                       0
IL12A                                       0
IL12RB1                                     0
IL18BP                                      0
IL27                                        0
IRF1                                        1
IRF7                                        1
ITK                                         0
JAK2                                        0
JAK3                                        0
KLRK1                                       0
LAG3                                        0
LAMP3                                       0
LILRA1                                      0
LILRB3                                      0
LYN                                         0
MCOLN2                                      0
P2RX7                                       0
PDCD1                                       0
PDCD1LG2                                    0
RELB                                        0
RIPK2                                       0
RNF19B                                      0
RSAD2                                       1
SERPING1                                    0
SIT1                                        0
SLAMF1                                      0
SLAMF6                                      0
SLAMF7                                      0
SLC11A1                                     0
TAP1                                        0
TAP2                                        0
TBX21                                       0
TLR8                                        0
TNFRSF11A                                   0
TNFRSF21                                    0
TNFSF13B                                    0
TNFSF18                                     0
ZC3H12A                                     0
CAMK2D                                      0
CIITA                                       0
GBP1                                        0
GBP2                                        1
MT2A                                        0
NLRC5                                       1
NMI                                         0
OAS2                                        1
PARP14                                      0
PML                                         0
SOCS1                                       0
STAT1                                       1
TRIM22                                      0
TRIM31                                      0
VCAM1                                       0
IFI27                                       1
IFI35                                       1
IFIT2                                       1
IFIT3                                       1
IFITM1                                      1
IFITM2                                      1
IFITM3                                      1
ISG20                                       1
PSMB8                                       1
STAT2                                       1
XAF1                                        1
ZBP1                                        1
TAPBP                                       0
AIM2                                        0
APOBEC3A                                    0
APOBEC3D                                    0
APOBEC3G                                    0
CXCL10                                      0
CXCL9                                       0
DDX60                                       0
DTX3L                                       0
GBP3                                        0
IFI44L                                      0
IFIH1                                       0
IFIT5                                       0
IL15                                        0
PMAIP1                                      0
RTP4                                        0
SERINC5                                     0
TLR7                                        0
TSPAN32                                     0
CCNE2                                       0
CDC45                                       0
CDC6                                        0
CDT1                                        0
MCM10                                       0
MCM2                                        0
MCM4                                        0
MCM5                                        0
MCM6                                        0
MCM7                                        0
ORC1                                        0
POLE2                                       0
TICRR                                       0
ACOD1                                       0
CALCOCO2                                    0
CCL13                                       0
CCL15                                       0
CCL18                                       0
CCL5                                        0
CCL7                                        0
CCL8                                        0
EDN1                                        0
GBP4                                        0
GBP5                                        0
GBP6                                        0
GBP7                                        0
GCH1                                        0
MEFV                                        0
NUB1                                        0
RAB20                                       0
UBD                                         0
ADAM8                                       0
ADGRE5                                      0
ADORA3                                      0
AGT                                         0
AOC3                                        0
APOL2                                       0
APOL3                                       0
APPL2                                       0
CASP4                                       0
CCRL2                                       0
CDH5                                        0
CFB                                         0
CFH                                         0
CR1L                                        0
CRHBP                                       0
CXCL11                                      0
CXCL5                                       0
CXCR3                                       0
CYLD                                        0
CYSLTR1                                     0
GGT5                                        0
GHRL                                        0
GSDMD                                       0
HGF                                         0
IDO1                                        0
IL1RN                                       0
IL22RA2                                     0
KARS1                                       0
KLF4                                        0
LRRK2                                       0
LY75                                        0
MMP25                                       0
MMP9                                        0
NLRP12                                      0
NOD2                                        0
OSM                                         0
POLB                                        0
PTGER4                                      0
SBNO2                                       0
SLAMF8                                      0
STAP1                                       0
SUCNR1                                      0
TGM2                                        0
TICAM2                                      0
TLR10                                       0
TLR5                                        0
TNFAIP6                                     0
BTN2A2                                      0
FYB1                                        0
PDE4B                                       0
PSMB10                                      0
PSMB9                                       0
PSME1                                       0
PSME2                                       0
APOL1                                       0
CD300LF                                     0
COLEC12                                     0
CX3CR1                                      0
FCN1                                        0
GRAMD4                                      0
H2BC21                                      0
ICAM2                                       0
LILRA2                                      0
MSRB1                                       0
MUC1                                        0
NCF1                                        0
OPTN                                        0
PYHIN1                                      0
TIFA                                        0
TRAFD1                                      0
GINS2                                       0
BATF2                                       0
CARD16                                      0
CARD17                                      0
CMPK2                                       0
LITAF                                       0
PADI2                                       0
KIF11                                       0
KIF15                                       0
KIF26A                                      0
          antigen processing and presentation of endogenous peptide antigen via MHC class I
B2M                                                                                       1
BCL6                                                                                      0
BTN3A1                                                                                    0
BTN3A2                                                                                    0
BTN3A3                                                                                    0
C1QB                                                                                      0
C1R                                                                                       0
C1RL                                                                                      0
C1S                                                                                       0
C2                                                                                        0
C3                                                                                        0
C4A                                                                                       0
C4B                                                                                       0
CD1A                                                                                      0
CD1C                                                                                      0
CD274                                                                                     0
CD28                                                                                      0
CD40                                                                                      0
CD7                                                                                       0
CD74                                                                                      0
CD80                                                                                      0
CEACAM1                                                                                   0
CLEC10A                                                                                   0
CLEC6A                                                                                    0
CTLA4                                                                                     0
CTSS                                                                                      0
ERAP2                                                                                     1
EXO1                                                                                      0
FGL1                                                                                      0
FGL2                                                                                      0
GCNT3                                                                                     0
GPR183                                                                                    0
HLA-A                                                                                     1
HLA-B                                                                                     1
HLA-C                                                                                     1
HLA-DMA                                                                                   0
HLA-DMB                                                                                   0
HLA-DOA                                                                                   0
HLA-DOB                                                                                   0
HLA-DPA1                                                                                  0
HLA-DPB1                                                                                  0
HLA-DQA1                                                                                  0
HLA-DQB1                                                                                  0
HLA-DQB2                                                                                  0
HLA-DRA                                                                                   0
HLA-DRB1                                                                                  0
HLA-DRB5                                                                                  0
HLA-E                                                                                     1
HLA-F                                                                                     1
HLA-G                                                                                     1
ICAM1                                                                                     0
IL12A                                                                                     0
IL12RB1                                                                                   0
IL18BP                                                                                    0
IL27                                                                                      0
IRF1                                                                                      0
IRF7                                                                                      0
ITK                                                                                       0
JAK2                                                                                      0
JAK3                                                                                      0
KLRK1                                                                                     0
LAG3                                                                                      0
LAMP3                                                                                     0
LILRA1                                                                                    0
LILRB3                                                                                    0
LYN                                                                                       0
MCOLN2                                                                                    0
P2RX7                                                                                     0
PDCD1                                                                                     0
PDCD1LG2                                                                                  0
RELB                                                                                      0
RIPK2                                                                                     0
RNF19B                                                                                    0
RSAD2                                                                                     0
SERPING1                                                                                  0
SIT1                                                                                      0
SLAMF1                                                                                    0
SLAMF6                                                                                    0
SLAMF7                                                                                    0
SLC11A1                                                                                   0
TAP1                                                                                      1
TAP2                                                                                      1
TBX21                                                                                     0
TLR8                                                                                      0
TNFRSF11A                                                                                 0
TNFRSF21                                                                                  0
TNFSF13B                                                                                  0
TNFSF18                                                                                   0
ZC3H12A                                                                                   0
CAMK2D                                                                                    0
CIITA                                                                                     0
GBP1                                                                                      0
GBP2                                                                                      0
MT2A                                                                                      0
NLRC5                                                                                     0
NMI                                                                                       0
OAS2                                                                                      0
PARP14                                                                                    0
PML                                                                                       0
SOCS1                                                                                     0
STAT1                                                                                     0
TRIM22                                                                                    0
TRIM31                                                                                    0
VCAM1                                                                                     0
IFI27                                                                                     0
IFI35                                                                                     0
IFIT2                                                                                     0
IFIT3                                                                                     0
IFITM1                                                                                    0
IFITM2                                                                                    0
IFITM3                                                                                    0
ISG20                                                                                     0
PSMB8                                                                                     0
STAT2                                                                                     0
XAF1                                                                                      0
ZBP1                                                                                      0
TAPBP                                                                                     1
AIM2                                                                                      0
APOBEC3A                                                                                  0
APOBEC3D                                                                                  0
APOBEC3G                                                                                  0
CXCL10                                                                                    0
CXCL9                                                                                     0
DDX60                                                                                     0
DTX3L                                                                                     0
GBP3                                                                                      0
IFI44L                                                                                    0
IFIH1                                                                                     0
IFIT5                                                                                     0
IL15                                                                                      0
PMAIP1                                                                                    0
RTP4                                                                                      0
SERINC5                                                                                   0
TLR7                                                                                      0
TSPAN32                                                                                   0
CCNE2                                                                                     0
CDC45                                                                                     0
CDC6                                                                                      0
CDT1                                                                                      0
MCM10                                                                                     0
MCM2                                                                                      0
MCM4                                                                                      0
MCM5                                                                                      0
MCM6                                                                                      0
MCM7                                                                                      0
ORC1                                                                                      0
POLE2                                                                                     0
TICRR                                                                                     0
ACOD1                                                                                     0
CALCOCO2                                                                                  0
CCL13                                                                                     0
CCL15                                                                                     0
CCL18                                                                                     0
CCL5                                                                                      0
CCL7                                                                                      0
CCL8                                                                                      0
EDN1                                                                                      0
GBP4                                                                                      0
GBP5                                                                                      0
GBP6                                                                                      0
GBP7                                                                                      0
GCH1                                                                                      0
MEFV                                                                                      0
NUB1                                                                                      0
RAB20                                                                                     0
UBD                                                                                       0
ADAM8                                                                                     0
ADGRE5                                                                                    0
ADORA3                                                                                    0
AGT                                                                                       0
AOC3                                                                                      0
APOL2                                                                                     0
APOL3                                                                                     0
APPL2                                                                                     0
CASP4                                                                                     0
CCRL2                                                                                     0
CDH5                                                                                      0
CFB                                                                                       0
CFH                                                                                       0
CR1L                                                                                      0
CRHBP                                                                                     0
CXCL11                                                                                    0
CXCL5                                                                                     0
CXCR3                                                                                     0
CYLD                                                                                      0
CYSLTR1                                                                                   0
GGT5                                                                                      0
GHRL                                                                                      0
GSDMD                                                                                     0
HGF                                                                                       0
IDO1                                                                                      0
IL1RN                                                                                     0
IL22RA2                                                                                   0
KARS1                                                                                     0
KLF4                                                                                      0
LRRK2                                                                                     0
LY75                                                                                      0
MMP25                                                                                     0
MMP9                                                                                      0
NLRP12                                                                                    0
NOD2                                                                                      0
OSM                                                                                       0
POLB                                                                                      0
PTGER4                                                                                    0
SBNO2                                                                                     0
SLAMF8                                                                                    0
STAP1                                                                                     0
SUCNR1                                                                                    0
TGM2                                                                                      0
TICAM2                                                                                    0
TLR10                                                                                     0
TLR5                                                                                      0
TNFAIP6                                                                                   0
BTN2A2                                                                                    0
FYB1                                                                                      0
PDE4B                                                                                     0
PSMB10                                                                                    0
PSMB9                                                                                     0
PSME1                                                                                     0
PSME2                                                                                     0
APOL1                                                                                     0
CD300LF                                                                                   0
COLEC12                                                                                   0
CX3CR1                                                                                    0
FCN1                                                                                      0
GRAMD4                                                                                    0
H2BC21                                                                                    0
ICAM2                                                                                     0
LILRA2                                                                                    0
MSRB1                                                                                     0
MUC1                                                                                      0
NCF1                                                                                      0
OPTN                                                                                      0
PYHIN1                                                                                    0
TIFA                                                                                      0
TRAFD1                                                                                    0
GINS2                                                                                     0
BATF2                                                                                     0
CARD16                                                                                    0
CARD17                                                                                    0
CMPK2                                                                                     0
LITAF                                                                                     0
PADI2                                                                                     0
KIF11                                                                                     0
KIF15                                                                                     0
KIF26A                                                                                    0
          defense response to virus
B2M                               0
BCL6                              0
BTN3A1                            0
BTN3A2                            0
BTN3A3                            0
C1QB                              0
C1R                               0
C1RL                              0
C1S                               0
C2                                0
C3                                0
C4A                               0
C4B                               0
CD1A                              0
CD1C                              0
CD274                             0
CD28                              0
CD40                              1
CD7                               0
CD74                              0
CD80                              0
CEACAM1                           0
CLEC10A                           0
CLEC6A                            0
CTLA4                             0
CTSS                              0
ERAP2                             0
EXO1                              0
FGL1                              0
FGL2                              1
GCNT3                             0
GPR183                            0
HLA-A                             0
HLA-B                             0
HLA-C                             0
HLA-DMA                           0
HLA-DMB                           0
HLA-DOA                           0
HLA-DOB                           0
HLA-DPA1                          0
HLA-DPB1                          0
HLA-DQA1                          0
HLA-DQB1                          0
HLA-DQB2                          0
HLA-DRA                           0
HLA-DRB1                          0
HLA-DRB5                          0
HLA-E                             0
HLA-F                             0
HLA-G                             0
ICAM1                             0
IL12A                             0
IL12RB1                           1
IL18BP                            0
IL27                              1
IRF1                              1
IRF7                              1
ITK                               0
JAK2                              0
JAK3                              0
KLRK1                             0
LAG3                              0
LAMP3                             0
LILRA1                            0
LILRB3                            0
LYN                               0
MCOLN2                            0
P2RX7                             0
PDCD1                             0
PDCD1LG2                          0
RELB                              0
RIPK2                             0
RNF19B                            0
RSAD2                             1
SERPING1                          0
SIT1                              0
SLAMF1                            0
SLAMF6                            0
SLAMF7                            0
SLC11A1                           0
TAP1                              0
TAP2                              0
TBX21                             0
TLR8                              1
TNFRSF11A                         0
TNFRSF21                          0
TNFSF13B                          0
TNFSF18                           0
ZC3H12A                           1
CAMK2D                            0
CIITA                             0
GBP1                              1
GBP2                              0
MT2A                              0
NLRC5                             1
NMI                               0
OAS2                              1
PARP14                            0
PML                               1
SOCS1                             0
STAT1                             1
TRIM22                            1
TRIM31                            0
VCAM1                             0
IFI27                             1
IFI35                             0
IFIT2                             1
IFIT3                             1
IFITM1                            1
IFITM2                            1
IFITM3                            1
ISG20                             1
PSMB8                             0
STAT2                             1
XAF1                              0
ZBP1                              0
TAPBP                             0
AIM2                              1
APOBEC3A                          1
APOBEC3D                          1
APOBEC3G                          1
CXCL10                            1
CXCL9                             1
DDX60                             1
DTX3L                             1
GBP3                              1
IFI44L                            1
IFIH1                             1
IFIT5                             1
IL15                              1
PMAIP1                            1
RTP4                              1
SERINC5                           1
TLR7                              1
TSPAN32                           1
CCNE2                             0
CDC45                             0
CDC6                              0
CDT1                              0
MCM10                             0
MCM2                              0
MCM4                              0
MCM5                              0
MCM6                              0
MCM7                              0
ORC1                              0
POLE2                             0
TICRR                             0
ACOD1                             0
CALCOCO2                          0
CCL13                             0
CCL15                             0
CCL18                             0
CCL5                              0
CCL7                              0
CCL8                              0
EDN1                              0
GBP4                              0
GBP5                              0
GBP6                              0
GBP7                              0
GCH1                              0
MEFV                              0
NUB1                              0
RAB20                             0
UBD                               0
ADAM8                             0
ADGRE5                            0
ADORA3                            0
AGT                               0
AOC3                              0
APOL2                             0
APOL3                             0
APPL2                             0
CASP4                             0
CCRL2                             0
CDH5                              0
CFB                               0
CFH                               0
CR1L                              0
CRHBP                             0
CXCL11                            0
CXCL5                             0
CXCR3                             0
CYLD                              0
CYSLTR1                           0
GGT5                              0
GHRL                              0
GSDMD                             0
HGF                               0
IDO1                              0
IL1RN                             0
IL22RA2                           0
KARS1                             0
KLF4                              0
LRRK2                             0
LY75                              0
MMP25                             0
MMP9                              0
NLRP12                            0
NOD2                              0
OSM                               0
POLB                              0
PTGER4                            0
SBNO2                             0
SLAMF8                            0
STAP1                             0
SUCNR1                            0
TGM2                              0
TICAM2                            0
TLR10                             0
TLR5                              0
TNFAIP6                           0
BTN2A2                            0
FYB1                              0
PDE4B                             0
PSMB10                            0
PSMB9                             0
PSME1                             0
PSME2                             0
APOL1                             0
CD300LF                           0
COLEC12                           0
CX3CR1                            0
FCN1                              0
GRAMD4                            0
H2BC21                            0
ICAM2                             0
LILRA2                            0
MSRB1                             0
MUC1                              0
NCF1                              0
OPTN                              0
PYHIN1                            0
TIFA                              0
TRAFD1                            0
GINS2                             0
BATF2                             0
CARD16                            0
CARD17                            0
CMPK2                             0
LITAF                             0
PADI2                             0
KIF11                             0
KIF15                             0
KIF26A                            0
          positive regulation of T cell mediated cytotoxicity
B2M                                                         1
BCL6                                                        0
BTN3A1                                                      0
BTN3A2                                                      0
BTN3A3                                                      0
C1QB                                                        0
C1R                                                         0
C1RL                                                        0
C1S                                                         0
C2                                                          0
C3                                                          0
C4A                                                         0
C4B                                                         0
CD1A                                                        1
CD1C                                                        1
CD274                                                       0
CD28                                                        0
CD40                                                        0
CD7                                                         0
CD74                                                        0
CD80                                                        0
CEACAM1                                                     0
CLEC10A                                                     0
CLEC6A                                                      0
CTLA4                                                       0
CTSS                                                        0
ERAP2                                                       0
EXO1                                                        0
FGL1                                                        0
FGL2                                                        0
GCNT3                                                       0
GPR183                                                      0
HLA-A                                                       1
HLA-B                                                       1
HLA-C                                                       1
HLA-DMA                                                     0
HLA-DMB                                                     0
HLA-DOA                                                     0
HLA-DOB                                                     0
HLA-DPA1                                                    0
HLA-DPB1                                                    0
HLA-DQA1                                                    0
HLA-DQB1                                                    0
HLA-DQB2                                                    0
HLA-DRA                                                     0
HLA-DRB1                                                    0
HLA-DRB5                                                    0
HLA-E                                                       1
HLA-F                                                       1
HLA-G                                                       1
ICAM1                                                       0
IL12A                                                       1
IL12RB1                                                     1
IL18BP                                                      0
IL27                                                        0
IRF1                                                        0
IRF7                                                        0
ITK                                                         0
JAK2                                                        0
JAK3                                                        0
KLRK1                                                       0
LAG3                                                        0
LAMP3                                                       0
LILRA1                                                      0
LILRB3                                                      0
LYN                                                         0
MCOLN2                                                      0
P2RX7                                                       1
PDCD1                                                       0
PDCD1LG2                                                    0
RELB                                                        0
RIPK2                                                       0
RNF19B                                                      0
RSAD2                                                       0
SERPING1                                                    0
SIT1                                                        0
SLAMF1                                                      0
SLAMF6                                                      0
SLAMF7                                                      0
SLC11A1                                                     0
TAP1                                                        0
TAP2                                                        0
TBX21                                                       0
TLR8                                                        0
TNFRSF11A                                                   0
TNFRSF21                                                    0
TNFSF13B                                                    0
TNFSF18                                                     0
ZC3H12A                                                     0
CAMK2D                                                      0
CIITA                                                       0
GBP1                                                        0
GBP2                                                        0
MT2A                                                        0
NLRC5                                                       0
NMI                                                         0
OAS2                                                        0
PARP14                                                      0
PML                                                         0
SOCS1                                                       0
STAT1                                                       0
TRIM22                                                      0
TRIM31                                                      0
VCAM1                                                       0
IFI27                                                       0
IFI35                                                       0
IFIT2                                                       0
IFIT3                                                       0
IFITM1                                                      0
IFITM2                                                      0
IFITM3                                                      0
ISG20                                                       0
PSMB8                                                       0
STAT2                                                       0
XAF1                                                        0
ZBP1                                                        0
TAPBP                                                       0
AIM2                                                        0
APOBEC3A                                                    0
APOBEC3D                                                    0
APOBEC3G                                                    0
CXCL10                                                      0
CXCL9                                                       0
DDX60                                                       0
DTX3L                                                       0
GBP3                                                        0
IFI44L                                                      0
IFIH1                                                       0
IFIT5                                                       0
IL15                                                        0
PMAIP1                                                      0
RTP4                                                        0
SERINC5                                                     0
TLR7                                                        0
TSPAN32                                                     0
CCNE2                                                       0
CDC45                                                       0
CDC6                                                        0
CDT1                                                        0
MCM10                                                       0
MCM2                                                        0
MCM4                                                        0
MCM5                                                        0
MCM6                                                        0
MCM7                                                        0
ORC1                                                        0
POLE2                                                       0
TICRR                                                       0
ACOD1                                                       0
CALCOCO2                                                    0
CCL13                                                       0
CCL15                                                       0
CCL18                                                       0
CCL5                                                        0
CCL7                                                        0
CCL8                                                        0
EDN1                                                        0
GBP4                                                        0
GBP5                                                        0
GBP6                                                        0
GBP7                                                        0
GCH1                                                        0
MEFV                                                        0
NUB1                                                        0
RAB20                                                       0
UBD                                                         0
ADAM8                                                       0
ADGRE5                                                      0
ADORA3                                                      0
AGT                                                         0
AOC3                                                        0
APOL2                                                       0
APOL3                                                       0
APPL2                                                       0
CASP4                                                       0
CCRL2                                                       0
CDH5                                                        0
CFB                                                         0
CFH                                                         0
CR1L                                                        0
CRHBP                                                       0
CXCL11                                                      0
CXCL5                                                       0
CXCR3                                                       0
CYLD                                                        0
CYSLTR1                                                     0
GGT5                                                        0
GHRL                                                        0
GSDMD                                                       0
HGF                                                         0
IDO1                                                        0
IL1RN                                                       0
IL22RA2                                                     0
KARS1                                                       0
KLF4                                                        0
LRRK2                                                       0
LY75                                                        0
MMP25                                                       0
MMP9                                                        0
NLRP12                                                      0
NOD2                                                        0
OSM                                                         0
POLB                                                        0
PTGER4                                                      0
SBNO2                                                       0
SLAMF8                                                      0
STAP1                                                       0
SUCNR1                                                      0
TGM2                                                        0
TICAM2                                                      0
TLR10                                                       0
TLR5                                                        0
TNFAIP6                                                     0
BTN2A2                                                      0
FYB1                                                        0
PDE4B                                                       0
PSMB10                                                      0
PSMB9                                                       0
PSME1                                                       0
PSME2                                                       0
APOL1                                                       0
CD300LF                                                     0
COLEC12                                                     0
CX3CR1                                                      0
FCN1                                                        0
GRAMD4                                                      0
H2BC21                                                      0
ICAM2                                                       0
LILRA2                                                      0
MSRB1                                                       0
MUC1                                                        0
NCF1                                                        0
OPTN                                                        0
PYHIN1                                                      0
TIFA                                                        0
TRAFD1                                                      0
GINS2                                                       0
BATF2                                                       0
CARD16                                                      0
CARD17                                                      0
CMPK2                                                       0
LITAF                                                       0
PADI2                                                       0
KIF11                                                       0
KIF15                                                       0
KIF26A                                                      0
          antigen processing and presentation via MHC class Ib
B2M                                                          1
BCL6                                                         0
BTN3A1                                                       0
BTN3A2                                                       0
BTN3A3                                                       0
C1QB                                                         0
C1R                                                          0
C1RL                                                         0
C1S                                                          0
C2                                                           0
C3                                                           0
C4A                                                          0
C4B                                                          0
CD1A                                                         1
CD1C                                                         1
CD274                                                        0
CD28                                                         0
CD40                                                         0
CD7                                                          0
CD74                                                         0
CD80                                                         0
CEACAM1                                                      0
CLEC10A                                                      0
CLEC6A                                                       0
CTLA4                                                        0
CTSS                                                         0
ERAP2                                                        0
EXO1                                                         0
FGL1                                                         0
FGL2                                                         0
GCNT3                                                        0
GPR183                                                       0
HLA-A                                                        1
HLA-B                                                        1
HLA-C                                                        1
HLA-DMA                                                      0
HLA-DMB                                                      0
HLA-DOA                                                      0
HLA-DOB                                                      0
HLA-DPA1                                                     0
HLA-DPB1                                                     0
HLA-DQA1                                                     0
HLA-DQB1                                                     0
HLA-DQB2                                                     0
HLA-DRA                                                      0
HLA-DRB1                                                     0
HLA-DRB5                                                     0
HLA-E                                                        1
HLA-F                                                        1
HLA-G                                                        1
ICAM1                                                        0
IL12A                                                        0
IL12RB1                                                      0
IL18BP                                                       0
IL27                                                         0
IRF1                                                         0
IRF7                                                         0
ITK                                                          0
JAK2                                                         0
JAK3                                                         0
KLRK1                                                        0
LAG3                                                         0
LAMP3                                                        0
LILRA1                                                       0
LILRB3                                                       0
LYN                                                          0
MCOLN2                                                       0
P2RX7                                                        0
PDCD1                                                        0
PDCD1LG2                                                     0
RELB                                                         0
RIPK2                                                        0
RNF19B                                                       0
RSAD2                                                        0
SERPING1                                                     0
SIT1                                                         0
SLAMF1                                                       0
SLAMF6                                                       0
SLAMF7                                                       0
SLC11A1                                                      0
TAP1                                                         0
TAP2                                                         1
TBX21                                                        0
TLR8                                                         0
TNFRSF11A                                                    0
TNFRSF21                                                     0
TNFSF13B                                                     0
TNFSF18                                                      0
ZC3H12A                                                      0
CAMK2D                                                       0
CIITA                                                        0
GBP1                                                         0
GBP2                                                         0
MT2A                                                         0
NLRC5                                                        0
NMI                                                          0
OAS2                                                         0
PARP14                                                       0
PML                                                          0
SOCS1                                                        0
STAT1                                                        0
TRIM22                                                       0
TRIM31                                                       0
VCAM1                                                        0
IFI27                                                        0
IFI35                                                        0
IFIT2                                                        0
IFIT3                                                        0
IFITM1                                                       0
IFITM2                                                       0
IFITM3                                                       0
ISG20                                                        0
PSMB8                                                        0
STAT2                                                        0
XAF1                                                         0
ZBP1                                                         0
TAPBP                                                        0
AIM2                                                         0
APOBEC3A                                                     0
APOBEC3D                                                     0
APOBEC3G                                                     0
CXCL10                                                       0
CXCL9                                                        0
DDX60                                                        0
DTX3L                                                        0
GBP3                                                         0
IFI44L                                                       0
IFIH1                                                        0
IFIT5                                                        0
IL15                                                         0
PMAIP1                                                       0
RTP4                                                         0
SERINC5                                                      0
TLR7                                                         0
TSPAN32                                                      0
CCNE2                                                        0
CDC45                                                        0
CDC6                                                         0
CDT1                                                         0
MCM10                                                        0
MCM2                                                         0
MCM4                                                         0
MCM5                                                         0
MCM6                                                         0
MCM7                                                         0
ORC1                                                         0
POLE2                                                        0
TICRR                                                        0
ACOD1                                                        0
CALCOCO2                                                     0
CCL13                                                        0
CCL15                                                        0
CCL18                                                        0
CCL5                                                         0
CCL7                                                         0
CCL8                                                         0
EDN1                                                         0
GBP4                                                         0
GBP5                                                         0
GBP6                                                         0
GBP7                                                         0
GCH1                                                         0
MEFV                                                         0
NUB1                                                         0
RAB20                                                        0
UBD                                                          0
ADAM8                                                        0
ADGRE5                                                       0
ADORA3                                                       0
AGT                                                          0
AOC3                                                         0
APOL2                                                        0
APOL3                                                        0
APPL2                                                        0
CASP4                                                        0
CCRL2                                                        0
CDH5                                                         0
CFB                                                          0
CFH                                                          0
CR1L                                                         0
CRHBP                                                        0
CXCL11                                                       0
CXCL5                                                        0
CXCR3                                                        0
CYLD                                                         0
CYSLTR1                                                      0
GGT5                                                         0
GHRL                                                         0
GSDMD                                                        0
HGF                                                          0
IDO1                                                         0
IL1RN                                                        0
IL22RA2                                                      0
KARS1                                                        0
KLF4                                                         0
LRRK2                                                        0
LY75                                                         0
MMP25                                                        0
MMP9                                                         0
NLRP12                                                       0
NOD2                                                         0
OSM                                                          0
POLB                                                         0
PTGER4                                                       0
SBNO2                                                        0
SLAMF8                                                       0
STAP1                                                        0
SUCNR1                                                       0
TGM2                                                         0
TICAM2                                                       0
TLR10                                                        0
TLR5                                                         0
TNFAIP6                                                      0
BTN2A2                                                       0
FYB1                                                         0
PDE4B                                                        0
PSMB10                                                       0
PSMB9                                                        0
PSME1                                                        0
PSME2                                                        0
APOL1                                                        0
CD300LF                                                      0
COLEC12                                                      0
CX3CR1                                                       0
FCN1                                                         0
GRAMD4                                                       0
H2BC21                                                       0
ICAM2                                                        0
LILRA2                                                       0
MSRB1                                                        0
MUC1                                                         0
NCF1                                                         0
OPTN                                                         0
PYHIN1                                                       0
TIFA                                                         0
TRAFD1                                                       0
GINS2                                                        0
BATF2                                                        0
CARD16                                                       0
CARD17                                                       0
CMPK2                                                        0
LITAF                                                        0
PADI2                                                        0
KIF11                                                        0
KIF15                                                        0
KIF26A                                                       0
          DNA replication initiation response to interferon-gamma
B2M                                0                            1
BCL6                               0                            0
BTN3A1                             0                            0
BTN3A2                             0                            0
BTN3A3                             0                            0
C1QB                               0                            0
C1R                                0                            0
C1RL                               0                            0
C1S                                0                            0
C2                                 0                            0
C3                                 0                            0
C4A                                0                            0
C4B                                0                            0
CD1A                               0                            0
CD1C                               0                            0
CD274                              0                            0
CD28                               0                            0
CD40                               0                            0
CD7                                0                            0
CD74                               0                            0
CD80                               0                            0
CEACAM1                            0                            0
CLEC10A                            0                            0
CLEC6A                             0                            0
CTLA4                              0                            0
CTSS                               0                            0
ERAP2                              0                            0
EXO1                               0                            0
FGL1                               0                            0
FGL2                               0                            0
GCNT3                              0                            0
GPR183                             0                            0
HLA-A                              0                            1
HLA-B                              0                            1
HLA-C                              0                            1
HLA-DMA                            0                            0
HLA-DMB                            0                            0
HLA-DOA                            0                            0
HLA-DOB                            0                            0
HLA-DPA1                           0                            1
HLA-DPB1                           0                            1
HLA-DQA1                           0                            1
HLA-DQB1                           0                            1
HLA-DQB2                           0                            1
HLA-DRA                            0                            1
HLA-DRB1                           0                            1
HLA-DRB5                           0                            1
HLA-E                              0                            1
HLA-F                              0                            1
HLA-G                              0                            1
ICAM1                              0                            1
IL12A                              0                            0
IL12RB1                            0                            1
IL18BP                             0                            0
IL27                               0                            0
IRF1                               0                            1
IRF7                               0                            1
ITK                                0                            0
JAK2                               0                            1
JAK3                               0                            0
KLRK1                              0                            0
LAG3                               0                            0
LAMP3                              0                            0
LILRA1                             0                            0
LILRB3                             0                            0
LYN                                0                            0
MCOLN2                             0                            0
P2RX7                              0                            0
PDCD1                              0                            0
PDCD1LG2                           0                            0
RELB                               0                            0
RIPK2                              0                            0
RNF19B                             0                            0
RSAD2                              0                            0
SERPING1                           0                            0
SIT1                               0                            0
SLAMF1                             0                            0
SLAMF6                             0                            0
SLAMF7                             0                            0
SLC11A1                            0                            1
TAP1                               0                            0
TAP2                               0                            0
TBX21                              0                            0
TLR8                               0                            0
TNFRSF11A                          0                            0
TNFRSF21                           0                            0
TNFSF13B                           0                            0
TNFSF18                            0                            0
ZC3H12A                            0                            0
CAMK2D                             0                            1
CIITA                              0                            1
GBP1                               0                            1
GBP2                               0                            1
MT2A                               0                            1
NLRC5                              0                            1
NMI                                0                            1
OAS2                               0                            1
PARP14                             0                            1
PML                                0                            1
SOCS1                              0                            1
STAT1                              0                            1
TRIM22                             0                            1
TRIM31                             0                            1
VCAM1                              0                            1
IFI27                              0                            0
IFI35                              0                            0
IFIT2                              0                            0
IFIT3                              0                            0
IFITM1                             0                            1
IFITM2                             0                            1
IFITM3                             0                            1
ISG20                              0                            0
PSMB8                              0                            0
STAT2                              0                            0
XAF1                               0                            0
ZBP1                               0                            0
TAPBP                              0                            0
AIM2                               0                            0
APOBEC3A                           0                            0
APOBEC3D                           0                            0
APOBEC3G                           0                            0
CXCL10                             0                            0
CXCL9                              0                            0
DDX60                              0                            0
DTX3L                              0                            0
GBP3                               0                            1
IFI44L                             0                            0
IFIH1                              0                            0
IFIT5                              0                            0
IL15                               0                            0
PMAIP1                             0                            0
RTP4                               0                            0
SERINC5                            0                            0
TLR7                               0                            0
TSPAN32                            0                            0
CCNE2                              1                            0
CDC45                              1                            0
CDC6                               1                            0
CDT1                               1                            0
MCM10                              1                            0
MCM2                               1                            0
MCM4                               1                            0
MCM5                               1                            0
MCM6                               1                            0
MCM7                               1                            0
ORC1                               1                            0
POLE2                              1                            0
TICRR                              1                            0
ACOD1                              0                            1
CALCOCO2                           0                            1
CCL13                              0                            1
CCL15                              0                            1
CCL18                              0                            1
CCL5                               0                            1
CCL7                               0                            1
CCL8                               0                            1
EDN1                               0                            1
GBP4                               0                            1
GBP5                               0                            1
GBP6                               0                            1
GBP7                               0                            1
GCH1                               0                            1
MEFV                               0                            1
NUB1                               0                            1
RAB20                              0                            1
UBD                                0                            1
ADAM8                              0                            0
ADGRE5                             0                            0
ADORA3                             0                            0
AGT                                0                            0
AOC3                               0                            0
APOL2                              0                            0
APOL3                              0                            0
APPL2                              0                            0
CASP4                              0                            0
CCRL2                              0                            0
CDH5                               0                            0
CFB                                0                            0
CFH                                0                            0
CR1L                               0                            0
CRHBP                              0                            0
CXCL11                             0                            0
CXCL5                              0                            0
CXCR3                              0                            0
CYLD                               0                            0
CYSLTR1                            0                            0
GGT5                               0                            0
GHRL                               0                            0
GSDMD                              0                            0
HGF                                0                            0
IDO1                               0                            0
IL1RN                              0                            0
IL22RA2                            0                            0
KARS1                              0                            0
KLF4                               0                            0
LRRK2                              0                            0
LY75                               0                            0
MMP25                              0                            0
MMP9                               0                            0
NLRP12                             0                            0
NOD2                               0                            0
OSM                                0                            0
POLB                               0                            0
PTGER4                             0                            0
SBNO2                              0                            0
SLAMF8                             0                            0
STAP1                              0                            0
SUCNR1                             0                            0
TGM2                               0                            0
TICAM2                             0                            0
TLR10                              0                            0
TLR5                               0                            0
TNFAIP6                            0                            0
BTN2A2                             0                            0
FYB1                               0                            0
PDE4B                              0                            0
PSMB10                             0                            0
PSMB9                              0                            0
PSME1                              0                            0
PSME2                              0                            0
APOL1                              0                            0
CD300LF                            0                            0
COLEC12                            0                            0
CX3CR1                             0                            0
FCN1                               0                            0
GRAMD4                             0                            0
H2BC21                             0                            0
ICAM2                              0                            0
LILRA2                             0                            0
MSRB1                              0                            0
MUC1                               0                            0
NCF1                               0                            0
OPTN                               0                            0
PYHIN1                             0                            0
TIFA                               0                            0
TRAFD1                             0                            0
GINS2                              0                            0
BATF2                              0                            0
CARD16                             0                            0
CARD17                             0                            0
CMPK2                              0                            0
LITAF                              0                            0
PADI2                              0                            0
KIF11                              0                            0
KIF15                              0                            0
KIF26A                             0                            0
          inflammatory response T cell receptor signaling pathway
B2M                           0                                 0
BCL6                          1                                 0
BTN3A1                        0                                 1
BTN3A2                        0                                 1
BTN3A3                        0                                 1
C1QB                          1                                 0
C1R                           1                                 0
C1RL                          0                                 0
C1S                           1                                 0
C2                            1                                 0
C3                            1                                 0
C4A                           1                                 0
C4B                           1                                 0
CD1A                          0                                 0
CD1C                          0                                 0
CD274                         0                                 0
CD28                          1                                 1
CD40                          1                                 0
CD7                           0                                 0
CD74                          0                                 0
CD80                          0                                 0
CEACAM1                       0                                 1
CLEC10A                       0                                 0
CLEC6A                        0                                 0
CTLA4                         0                                 1
CTSS                          0                                 0
ERAP2                         0                                 0
EXO1                          0                                 0
FGL1                          0                                 0
FGL2                          0                                 0
GCNT3                         0                                 0
GPR183                        0                                 0
HLA-A                         0                                 0
HLA-B                         0                                 0
HLA-C                         0                                 0
HLA-DMA                       0                                 0
HLA-DMB                       0                                 0
HLA-DOA                       0                                 0
HLA-DOB                       0                                 0
HLA-DPA1                      0                                 1
HLA-DPB1                      0                                 1
HLA-DQA1                      0                                 1
HLA-DQB1                      0                                 1
HLA-DQB2                      0                                 1
HLA-DRA                       0                                 1
HLA-DRB1                      0                                 1
HLA-DRB5                      0                                 1
HLA-E                         1                                 0
HLA-F                         0                                 0
HLA-G                         0                                 0
ICAM1                         1                                 0
IL12A                         0                                 0
IL12RB1                       0                                 0
IL18BP                        0                                 0
IL27                          1                                 0
IRF1                          0                                 0
IRF7                          0                                 0
ITK                           0                                 1
JAK2                          1                                 0
JAK3                          0                                 0
KLRK1                         0                                 0
LAG3                          0                                 0
LAMP3                         0                                 0
LILRA1                        0                                 0
LILRB3                        0                                 0
LYN                           1                                 0
MCOLN2                        0                                 0
P2RX7                         1                                 0
PDCD1                         0                                 0
PDCD1LG2                      0                                 0
RELB                          1                                 0
RIPK2                         1                                 1
RNF19B                        0                                 0
RSAD2                         0                                 0
SERPING1                      1                                 0
SIT1                          0                                 0
SLAMF1                        0                                 0
SLAMF6                        0                                 0
SLAMF7                        0                                 0
SLC11A1                       1                                 0
TAP1                          0                                 0
TAP2                          0                                 0
TBX21                         0                                 0
TLR8                          1                                 0
TNFRSF11A                     1                                 0
TNFRSF21                      0                                 1
TNFSF13B                      0                                 0
TNFSF18                       0                                 0
ZC3H12A                       1                                 1
CAMK2D                        0                                 0
CIITA                         1                                 0
GBP1                          0                                 1
GBP2                          0                                 0
MT2A                          0                                 0
NLRC5                         0                                 0
NMI                           1                                 0
OAS2                          0                                 0
PARP14                        0                                 0
PML                           0                                 0
SOCS1                         0                                 0
STAT1                         0                                 0
TRIM22                        0                                 0
TRIM31                        0                                 0
VCAM1                         1                                 0
IFI27                         0                                 0
IFI35                         0                                 0
IFIT2                         0                                 0
IFIT3                         0                                 0
IFITM1                        0                                 0
IFITM2                        0                                 0
IFITM3                        0                                 0
ISG20                         0                                 0
PSMB8                         0                                 1
STAT2                         0                                 0
XAF1                          0                                 0
ZBP1                          0                                 0
TAPBP                         0                                 0
AIM2                          1                                 0
APOBEC3A                      0                                 0
APOBEC3D                      0                                 0
APOBEC3G                      0                                 0
CXCL10                        1                                 0
CXCL9                         1                                 0
DDX60                         0                                 0
DTX3L                         0                                 0
GBP3                          0                                 0
IFI44L                        0                                 0
IFIH1                         0                                 0
IFIT5                         0                                 0
IL15                          1                                 0
PMAIP1                        0                                 0
RTP4                          0                                 0
SERINC5                       0                                 0
TLR7                          1                                 0
TSPAN32                       0                                 0
CCNE2                         0                                 0
CDC45                         0                                 0
CDC6                          0                                 0
CDT1                          0                                 0
MCM10                         0                                 0
MCM2                          0                                 0
MCM4                          0                                 0
MCM5                          0                                 0
MCM6                          0                                 0
MCM7                          0                                 0
ORC1                          0                                 0
POLE2                         0                                 0
TICRR                         0                                 0
ACOD1                         1                                 0
CALCOCO2                      0                                 0
CCL13                         1                                 0
CCL15                         1                                 0
CCL18                         1                                 0
CCL5                          1                                 0
CCL7                          1                                 0
CCL8                          1                                 0
EDN1                          0                                 0
GBP4                          0                                 0
GBP5                          1                                 0
GBP6                          0                                 0
GBP7                          0                                 0
GCH1                          0                                 0
MEFV                          1                                 0
NUB1                          0                                 0
RAB20                         0                                 0
UBD                           0                                 0
ADAM8                         1                                 0
ADGRE5                        1                                 0
ADORA3                        1                                 0
AGT                           1                                 0
AOC3                          1                                 0
APOL2                         1                                 0
APOL3                         1                                 0
APPL2                         1                                 0
CASP4                         1                                 0
CCRL2                         1                                 0
CDH5                          1                                 0
CFB                           1                                 0
CFH                           1                                 0
CR1L                          1                                 0
CRHBP                         1                                 0
CXCL11                        1                                 0
CXCL5                         1                                 0
CXCR3                         1                                 0
CYLD                          1                                 1
CYSLTR1                       1                                 0
GGT5                          1                                 0
GHRL                          1                                 0
GSDMD                         1                                 0
HGF                           1                                 0
IDO1                          1                                 0
IL1RN                         1                                 0
IL22RA2                       1                                 0
KARS1                         1                                 0
KLF4                          1                                 0
LRRK2                         1                                 0
LY75                          1                                 0
MMP25                         1                                 0
MMP9                          1                                 0
NLRP12                        1                                 0
NOD2                          1                                 0
OSM                           1                                 0
POLB                          1                                 0
PTGER4                        1                                 0
SBNO2                         1                                 0
SLAMF8                        1                                 0
STAP1                         1                                 0
SUCNR1                        1                                 0
TGM2                          1                                 0
TICAM2                        1                                 0
TLR10                         1                                 0
TLR5                          1                                 0
TNFAIP6                       1                                 0
BTN2A2                        0                                 1
FYB1                          0                                 1
PDE4B                         0                                 1
PSMB10                        0                                 1
PSMB9                         0                                 1
PSME1                         0                                 1
PSME2                         0                                 1
APOL1                         0                                 0
CD300LF                       0                                 0
COLEC12                       0                                 0
CX3CR1                        0                                 0
FCN1                          0                                 0
GRAMD4                        0                                 0
H2BC21                        0                                 0
ICAM2                         0                                 0
LILRA2                        0                                 0
MSRB1                         0                                 0
MUC1                          0                                 0
NCF1                          0                                 0
OPTN                          0                                 0
PYHIN1                        0                                 0
TIFA                          0                                 0
TRAFD1                        0                                 0
GINS2                         0                                 0
BATF2                         0                                 0
CARD16                        0                                 0
CARD17                        0                                 0
CMPK2                         0                                 0
LITAF                         0                                 0
PADI2                         0                                 0
KIF11                         0                                 0
KIF15                         0                                 0
KIF26A                        0                                 0
          innate immune response complement activation, classical pathway
B2M                            1                                        0
BCL6                           0                                        0
BTN3A1                         0                                        0
BTN3A2                         0                                        0
BTN3A3                         0                                        0
C1QB                           1                                        1
C1R                            1                                        1
C1RL                           1                                        1
C1S                            1                                        1
C2                             1                                        1
C3                             1                                        1
C4A                            1                                        1
C4B                            1                                        1
CD1A                           0                                        0
CD1C                           0                                        0
CD274                          0                                        0
CD28                           0                                        0
CD40                           0                                        0
CD7                            0                                        0
CD74                           0                                        0
CD80                           0                                        0
CEACAM1                        1                                        0
CLEC10A                        1                                        0
CLEC6A                         1                                        0
CTLA4                          0                                        0
CTSS                           1                                        0
ERAP2                          0                                        0
EXO1                           0                                        0
FGL1                           0                                        0
FGL2                           0                                        0
GCNT3                          0                                        0
GPR183                         0                                        0
HLA-A                          1                                        0
HLA-B                          1                                        0
HLA-C                          1                                        0
HLA-DMA                        0                                        0
HLA-DMB                        0                                        0
HLA-DOA                        0                                        0
HLA-DOB                        0                                        0
HLA-DPA1                       1                                        0
HLA-DPB1                       1                                        0
HLA-DQA1                       1                                        0
HLA-DQB1                       1                                        0
HLA-DQB2                       1                                        0
HLA-DRA                        1                                        0
HLA-DRB1                       1                                        0
HLA-DRB5                       1                                        0
HLA-E                          1                                        0
HLA-F                          1                                        0
HLA-G                          1                                        0
ICAM1                          1                                        0
IL12A                          1                                        0
IL12RB1                        1                                        0
IL18BP                         0                                        0
IL27                           1                                        0
IRF1                           1                                        0
IRF7                           1                                        0
ITK                            0                                        0
JAK2                           1                                        0
JAK3                           1                                        0
KLRK1                          1                                        0
LAG3                           1                                        0
LAMP3                          0                                        0
LILRA1                         0                                        0
LILRB3                         0                                        0
LYN                            1                                        0
MCOLN2                         1                                        0
P2RX7                          0                                        0
PDCD1                          0                                        0
PDCD1LG2                       0                                        0
RELB                           1                                        0
RIPK2                          1                                        0
RNF19B                         0                                        0
RSAD2                          1                                        0
SERPING1                       1                                        1
SIT1                           0                                        0
SLAMF1                         1                                        0
SLAMF6                         1                                        0
SLAMF7                         1                                        0
SLC11A1                        1                                        0
TAP1                           0                                        0
TAP2                           0                                        0
TBX21                          0                                        0
TLR8                           1                                        0
TNFRSF11A                      0                                        0
TNFRSF21                       0                                        0
TNFSF13B                       0                                        0
TNFSF18                        0                                        0
ZC3H12A                        0                                        0
CAMK2D                         1                                        0
CIITA                          1                                        0
GBP1                           1                                        0
GBP2                           1                                        0
MT2A                           1                                        0
NLRC5                          1                                        0
NMI                            1                                        0
OAS2                           1                                        0
PARP14                         1                                        0
PML                            1                                        0
SOCS1                          1                                        0
STAT1                          1                                        0
TRIM22                         1                                        0
TRIM31                         1                                        0
VCAM1                          1                                        0
IFI27                          1                                        0
IFI35                          1                                        0
IFIT2                          1                                        0
IFIT3                          1                                        0
IFITM1                         1                                        0
IFITM2                         1                                        0
IFITM3                         1                                        0
ISG20                          1                                        0
PSMB8                          1                                        0
STAT2                          1                                        0
XAF1                           1                                        0
ZBP1                           1                                        0
TAPBP                          0                                        0
AIM2                           1                                        0
APOBEC3A                       1                                        0
APOBEC3D                       1                                        0
APOBEC3G                       1                                        0
CXCL10                         0                                        0
CXCL9                          0                                        0
DDX60                          1                                        0
DTX3L                          1                                        0
GBP3                           1                                        0
IFI44L                         0                                        0
IFIH1                          1                                        0
IFIT5                          1                                        0
IL15                           0                                        0
PMAIP1                         0                                        0
RTP4                           0                                        0
SERINC5                        1                                        0
TLR7                           1                                        0
TSPAN32                        0                                        0
CCNE2                          0                                        0
CDC45                          0                                        0
CDC6                           0                                        0
CDT1                           0                                        0
MCM10                          0                                        0
MCM2                           0                                        0
MCM4                           0                                        0
MCM5                           0                                        0
MCM6                           0                                        0
MCM7                           0                                        0
ORC1                           0                                        0
POLE2                          0                                        0
TICRR                          0                                        0
ACOD1                          1                                        0
CALCOCO2                       1                                        0
CCL13                          1                                        0
CCL15                          1                                        0
CCL18                          1                                        0
CCL5                           1                                        0
CCL7                           1                                        0
CCL8                           1                                        0
EDN1                           1                                        0
GBP4                           1                                        0
GBP5                           1                                        0
GBP6                           1                                        0
GBP7                           1                                        0
GCH1                           1                                        0
MEFV                           1                                        0
NUB1                           1                                        0
RAB20                          1                                        0
UBD                            1                                        0
ADAM8                          1                                        0
ADGRE5                         0                                        0
ADORA3                         0                                        0
AGT                            0                                        0
AOC3                           0                                        0
APOL2                          0                                        0
APOL3                          0                                        0
APPL2                          1                                        0
CASP4                          1                                        0
CCRL2                          0                                        0
CDH5                           0                                        0
CFB                            1                                        0
CFH                            1                                        0
CR1L                           0                                        0
CRHBP                          0                                        0
CXCL11                         0                                        0
CXCL5                          0                                        0
CXCR3                          0                                        0
CYLD                           1                                        0
CYSLTR1                        0                                        0
GGT5                           0                                        0
GHRL                           0                                        0
GSDMD                          1                                        0
HGF                            0                                        0
IDO1                           0                                        0
IL1RN                          0                                        0
IL22RA2                        0                                        0
KARS1                          0                                        0
KLF4                           0                                        0
LRRK2                          0                                        0
LY75                           0                                        0
MMP25                          0                                        0
MMP9                           0                                        0
NLRP12                         0                                        0
NOD2                           1                                        0
OSM                            0                                        0
POLB                           0                                        0
PTGER4                         0                                        0
SBNO2                          0                                        0
SLAMF8                         1                                        0
STAP1                          0                                        0
SUCNR1                         0                                        0
TGM2                           0                                        0
TICAM2                         1                                        0
TLR10                          1                                        0
TLR5                           1                                        0
TNFAIP6                        0                                        0
BTN2A2                         0                                        0
FYB1                           0                                        0
PDE4B                          0                                        0
PSMB10                         1                                        0
PSMB9                          1                                        0
PSME1                          1                                        0
PSME2                          1                                        0
APOL1                          1                                        0
CD300LF                        1                                        0
COLEC12                        1                                        0
CX3CR1                         1                                        0
FCN1                           1                                        0
GRAMD4                         1                                        0
H2BC21                         1                                        0
ICAM2                          1                                        0
LILRA2                         1                                        0
MSRB1                          1                                        0
MUC1                           1                                        0
NCF1                           1                                        0
OPTN                           1                                        0
PYHIN1                         1                                        0
TIFA                           1                                        0
TRAFD1                         1                                        0
GINS2                          0                                        0
BATF2                          0                                        0
CARD16                         0                                        0
CARD17                         0                                        0
CMPK2                          0                                        0
LITAF                          0                                        0
PADI2                          0                                        0
KIF11                          0                                        0
KIF15                          0                                        0
KIF26A                         0                                        0
          double-strand break repair via break-induced replication
B2M                                                              0
BCL6                                                             0
BTN3A1                                                           0
BTN3A2                                                           0
BTN3A3                                                           0
C1QB                                                             0
C1R                                                              0
C1RL                                                             0
C1S                                                              0
C2                                                               0
C3                                                               0
C4A                                                              0
C4B                                                              0
CD1A                                                             0
CD1C                                                             0
CD274                                                            0
CD28                                                             0
CD40                                                             0
CD7                                                              0
CD74                                                             0
CD80                                                             0
CEACAM1                                                          0
CLEC10A                                                          0
CLEC6A                                                           0
CTLA4                                                            0
CTSS                                                             0
ERAP2                                                            0
EXO1                                                             0
FGL1                                                             0
FGL2                                                             0
GCNT3                                                            0
GPR183                                                           0
HLA-A                                                            0
HLA-B                                                            0
HLA-C                                                            0
HLA-DMA                                                          0
HLA-DMB                                                          0
HLA-DOA                                                          0
HLA-DOB                                                          0
HLA-DPA1                                                         0
HLA-DPB1                                                         0
HLA-DQA1                                                         0
HLA-DQB1                                                         0
HLA-DQB2                                                         0
HLA-DRA                                                          0
HLA-DRB1                                                         0
HLA-DRB5                                                         0
HLA-E                                                            0
HLA-F                                                            0
HLA-G                                                            0
ICAM1                                                            0
IL12A                                                            0
IL12RB1                                                          0
IL18BP                                                           0
IL27                                                             0
IRF1                                                             0
IRF7                                                             0
ITK                                                              0
JAK2                                                             0
JAK3                                                             0
KLRK1                                                            0
LAG3                                                             0
LAMP3                                                            0
LILRA1                                                           0
LILRB3                                                           0
LYN                                                              0
MCOLN2                                                           0
P2RX7                                                            0
PDCD1                                                            0
PDCD1LG2                                                         0
RELB                                                             0
RIPK2                                                            0
RNF19B                                                           0
RSAD2                                                            0
SERPING1                                                         0
SIT1                                                             0
SLAMF1                                                           0
SLAMF6                                                           0
SLAMF7                                                           0
SLC11A1                                                          0
TAP1                                                             0
TAP2                                                             0
TBX21                                                            0
TLR8                                                             0
TNFRSF11A                                                        0
TNFRSF21                                                         0
TNFSF13B                                                         0
TNFSF18                                                          0
ZC3H12A                                                          0
CAMK2D                                                           0
CIITA                                                            0
GBP1                                                             0
GBP2                                                             0
MT2A                                                             0
NLRC5                                                            0
NMI                                                              0
OAS2                                                             0
PARP14                                                           0
PML                                                              0
SOCS1                                                            0
STAT1                                                            0
TRIM22                                                           0
TRIM31                                                           0
VCAM1                                                            0
IFI27                                                            0
IFI35                                                            0
IFIT2                                                            0
IFIT3                                                            0
IFITM1                                                           0
IFITM2                                                           0
IFITM3                                                           0
ISG20                                                            0
PSMB8                                                            0
STAT2                                                            0
XAF1                                                             0
ZBP1                                                             0
TAPBP                                                            0
AIM2                                                             0
APOBEC3A                                                         0
APOBEC3D                                                         0
APOBEC3G                                                         0
CXCL10                                                           0
CXCL9                                                            0
DDX60                                                            0
DTX3L                                                            0
GBP3                                                             0
IFI44L                                                           0
IFIH1                                                            0
IFIT5                                                            0
IL15                                                             0
PMAIP1                                                           0
RTP4                                                             0
SERINC5                                                          0
TLR7                                                             0
TSPAN32                                                          0
CCNE2                                                            0
CDC45                                                            1
CDC6                                                             0
CDT1                                                             0
MCM10                                                            0
MCM2                                                             1
MCM4                                                             1
MCM5                                                             1
MCM6                                                             1
MCM7                                                             1
ORC1                                                             0
POLE2                                                            0
TICRR                                                            0
ACOD1                                                            0
CALCOCO2                                                         0
CCL13                                                            0
CCL15                                                            0
CCL18                                                            0
CCL5                                                             0
CCL7                                                             0
CCL8                                                             0
EDN1                                                             0
GBP4                                                             0
GBP5                                                             0
GBP6                                                             0
GBP7                                                             0
GCH1                                                             0
MEFV                                                             0
NUB1                                                             0
RAB20                                                            0
UBD                                                              0
ADAM8                                                            0
ADGRE5                                                           0
ADORA3                                                           0
AGT                                                              0
AOC3                                                             0
APOL2                                                            0
APOL3                                                            0
APPL2                                                            0
CASP4                                                            0
CCRL2                                                            0
CDH5                                                             0
CFB                                                              0
CFH                                                              0
CR1L                                                             0
CRHBP                                                            0
CXCL11                                                           0
CXCL5                                                            0
CXCR3                                                            0
CYLD                                                             0
CYSLTR1                                                          0
GGT5                                                             0
GHRL                                                             0
GSDMD                                                            0
HGF                                                              0
IDO1                                                             0
IL1RN                                                            0
IL22RA2                                                          0
KARS1                                                            0
KLF4                                                             0
LRRK2                                                            0
LY75                                                             0
MMP25                                                            0
MMP9                                                             0
NLRP12                                                           0
NOD2                                                             0
OSM                                                              0
POLB                                                             0
PTGER4                                                           0
SBNO2                                                            0
SLAMF8                                                           0
STAP1                                                            0
SUCNR1                                                           0
TGM2                                                             0
TICAM2                                                           0
TLR10                                                            0
TLR5                                                             0
TNFAIP6                                                          0
BTN2A2                                                           0
FYB1                                                             0
PDE4B                                                            0
PSMB10                                                           0
PSMB9                                                            0
PSME1                                                            0
PSME2                                                            0
APOL1                                                            0
CD300LF                                                          0
COLEC12                                                          0
CX3CR1                                                           0
FCN1                                                             0
GRAMD4                                                           0
H2BC21                                                           0
ICAM2                                                            0
LILRA2                                                           0
MSRB1                                                            0
MUC1                                                             0
NCF1                                                             0
OPTN                                                             0
PYHIN1                                                           0
TIFA                                                             0
TRAFD1                                                           0
GINS2                                                            1
BATF2                                                            0
CARD16                                                           0
CARD17                                                           0
CMPK2                                                            0
LITAF                                                            0
PADI2                                                            0
KIF11                                                            0
KIF15                                                            0
KIF26A                                                           0
          defense response to protozoan cellular response to lipopolysaccharide
B2M                                   0                                       0
BCL6                                  0                                       0
BTN3A1                                0                                       0
BTN3A2                                0                                       0
BTN3A3                                0                                       0
C1QB                                  0                                       0
C1R                                   0                                       0
C1RL                                  0                                       0
C1S                                   0                                       0
C2                                    0                                       0
C3                                    0                                       0
C4A                                   0                                       0
C4B                                   0                                       0
CD1A                                  0                                       0
CD1C                                  0                                       0
CD274                                 0                                       1
CD28                                  0                                       0
CD40                                  1                                       0
CD7                                   0                                       0
CD74                                  0                                       0
CD80                                  0                                       1
CEACAM1                               0                                       0
CLEC10A                               0                                       0
CLEC6A                                0                                       0
CTLA4                                 0                                       0
CTSS                                  0                                       0
ERAP2                                 0                                       0
EXO1                                  0                                       0
FGL1                                  0                                       0
FGL2                                  0                                       0
GCNT3                                 0                                       0
GPR183                                0                                       0
HLA-A                                 0                                       0
HLA-B                                 0                                       0
HLA-C                                 0                                       0
HLA-DMA                               0                                       0
HLA-DMB                               0                                       0
HLA-DOA                               0                                       0
HLA-DOB                               0                                       0
HLA-DPA1                              0                                       0
HLA-DPB1                              0                                       0
HLA-DQA1                              0                                       0
HLA-DQB1                              0                                       0
HLA-DQB2                              0                                       0
HLA-DRA                               0                                       0
HLA-DRB1                              0                                       0
HLA-DRB5                              0                                       0
HLA-E                                 0                                       0
HLA-F                                 0                                       0
HLA-G                                 0                                       0
ICAM1                                 0                                       1
IL12A                                 1                                       1
IL12RB1                               0                                       0
IL18BP                                0                                       0
IL27                                  0                                       0
IRF1                                  0                                       0
IRF7                                  0                                       0
ITK                                   0                                       0
JAK2                                  0                                       0
JAK3                                  0                                       0
KLRK1                                 0                                       1
LAG3                                  0                                       0
LAMP3                                 0                                       0
LILRA1                                0                                       0
LILRB3                                0                                       0
LYN                                   0                                       1
MCOLN2                                0                                       0
P2RX7                                 0                                       0
PDCD1                                 0                                       0
PDCD1LG2                              0                                       1
RELB                                  0                                       0
RIPK2                                 0                                       1
RNF19B                                0                                       0
RSAD2                                 0                                       0
SERPING1                              0                                       0
SIT1                                  0                                       0
SLAMF1                                0                                       0
SLAMF6                                0                                       0
SLAMF7                                0                                       0
SLC11A1                               1                                       0
TAP1                                  0                                       0
TAP2                                  0                                       0
TBX21                                 0                                       0
TLR8                                  0                                       0
TNFRSF11A                             0                                       0
TNFRSF21                              0                                       0
TNFSF13B                              0                                       0
TNFSF18                               0                                       0
ZC3H12A                               0                                       1
CAMK2D                                0                                       0
CIITA                                 0                                       0
GBP1                                  0                                       0
GBP2                                  1                                       0
MT2A                                  0                                       0
NLRC5                                 0                                       0
NMI                                   0                                       0
OAS2                                  0                                       0
PARP14                                0                                       0
PML                                   0                                       0
SOCS1                                 0                                       0
STAT1                                 0                                       0
TRIM22                                0                                       0
TRIM31                                0                                       0
VCAM1                                 0                                       0
IFI27                                 0                                       0
IFI35                                 0                                       0
IFIT2                                 0                                       0
IFIT3                                 0                                       0
IFITM1                                0                                       0
IFITM2                                0                                       0
IFITM3                                0                                       0
ISG20                                 0                                       0
PSMB8                                 0                                       0
STAT2                                 0                                       0
XAF1                                  0                                       0
ZBP1                                  0                                       0
TAPBP                                 0                                       0
AIM2                                  0                                       0
APOBEC3A                              0                                       0
APOBEC3D                              0                                       0
APOBEC3G                              0                                       0
CXCL10                                0                                       1
CXCL9                                 0                                       1
DDX60                                 0                                       0
DTX3L                                 0                                       0
GBP3                                  0                                       0
IFI44L                                0                                       0
IFIH1                                 0                                       0
IFIT5                                 0                                       0
IL15                                  0                                       0
PMAIP1                                0                                       0
RTP4                                  0                                       0
SERINC5                               0                                       0
TLR7                                  0                                       0
TSPAN32                               1                                       0
CCNE2                                 0                                       0
CDC45                                 0                                       0
CDC6                                  0                                       0
CDT1                                  0                                       0
MCM10                                 0                                       0
MCM2                                  0                                       0
MCM4                                  0                                       0
MCM5                                  0                                       0
MCM6                                  0                                       0
MCM7                                  0                                       0
ORC1                                  0                                       0
POLE2                                 0                                       0
TICRR                                 0                                       0
ACOD1                                 0                                       1
CALCOCO2                              0                                       0
CCL13                                 0                                       0
CCL15                                 0                                       0
CCL18                                 0                                       0
CCL5                                  0                                       1
CCL7                                  0                                       0
CCL8                                  0                                       0
EDN1                                  0                                       0
GBP4                                  1                                       0
GBP5                                  0                                       0
GBP6                                  1                                       0
GBP7                                  1                                       0
GCH1                                  0                                       0
MEFV                                  0                                       0
NUB1                                  0                                       0
RAB20                                 0                                       0
UBD                                   0                                       0
ADAM8                                 0                                       0
ADGRE5                                0                                       0
ADORA3                                0                                       0
AGT                                   0                                       0
AOC3                                  0                                       0
APOL2                                 0                                       0
APOL3                                 0                                       0
APPL2                                 0                                       0
CASP4                                 0                                       0
CCRL2                                 0                                       0
CDH5                                  0                                       0
CFB                                   0                                       0
CFH                                   0                                       0
CR1L                                  0                                       0
CRHBP                                 0                                       0
CXCL11                                0                                       1
CXCL5                                 0                                       1
CXCR3                                 0                                       0
CYLD                                  0                                       0
CYSLTR1                               0                                       0
GGT5                                  0                                       0
GHRL                                  0                                       0
GSDMD                                 0                                       0
HGF                                   0                                       0
IDO1                                  0                                       0
IL1RN                                 0                                       1
IL22RA2                               0                                       0
KARS1                                 0                                       0
KLF4                                  0                                       0
LRRK2                                 0                                       0
LY75                                  0                                       0
MMP25                                 0                                       0
MMP9                                  0                                       0
NLRP12                                0                                       0
NOD2                                  0                                       1
OSM                                   0                                       0
POLB                                  0                                       0
PTGER4                                0                                       0
SBNO2                                 0                                       1
SLAMF8                                0                                       0
STAP1                                 0                                       1
SUCNR1                                0                                       0
TGM2                                  0                                       0
TICAM2                                0                                       1
TLR10                                 0                                       0
TLR5                                  0                                       0
TNFAIP6                               0                                       0
BTN2A2                                0                                       0
FYB1                                  0                                       0
PDE4B                                 0                                       1
PSMB10                                0                                       0
PSMB9                                 0                                       0
PSME1                                 0                                       0
PSME2                                 0                                       0
APOL1                                 0                                       0
CD300LF                               0                                       0
COLEC12                               0                                       0
CX3CR1                                0                                       1
FCN1                                  0                                       0
GRAMD4                                0                                       0
H2BC21                                0                                       0
ICAM2                                 0                                       0
LILRA2                                0                                       1
MSRB1                                 0                                       0
MUC1                                  0                                       0
NCF1                                  0                                       0
OPTN                                  0                                       0
PYHIN1                                0                                       0
TIFA                                  0                                       0
TRAFD1                                0                                       0
GINS2                                 0                                       0
BATF2                                 1                                       0
CARD16                                0                                       1
CARD17                                0                                       1
CMPK2                                 0                                       1
LITAF                                 0                                       1
PADI2                                 0                                       0
KIF11                                 0                                       0
KIF15                                 0                                       0
KIF26A                                0                                       0
          regulation of complement activation
B2M                                         0
BCL6                                        0
BTN3A1                                      0
BTN3A2                                      0
BTN3A3                                      0
C1QB                                        1
C1R                                         1
C1RL                                        0
C1S                                         1
C2                                          1
C3                                          1
C4A                                         1
C4B                                         1
CD1A                                        0
CD1C                                        0
CD274                                       0
CD28                                        0
CD40                                        0
CD7                                         0
CD74                                        0
CD80                                        0
CEACAM1                                     0
CLEC10A                                     0
CLEC6A                                      0
CTLA4                                       0
CTSS                                        0
ERAP2                                       0
EXO1                                        0
FGL1                                        0
FGL2                                        0
GCNT3                                       0
GPR183                                      0
HLA-A                                       0
HLA-B                                       0
HLA-C                                       0
HLA-DMA                                     0
HLA-DMB                                     0
HLA-DOA                                     0
HLA-DOB                                     0
HLA-DPA1                                    0
HLA-DPB1                                    0
HLA-DQA1                                    0
HLA-DQB1                                    0
HLA-DQB2                                    0
HLA-DRA                                     0
HLA-DRB1                                    0
HLA-DRB5                                    0
HLA-E                                       0
HLA-F                                       0
HLA-G                                       0
ICAM1                                       0
IL12A                                       0
IL12RB1                                     0
IL18BP                                      0
IL27                                        0
IRF1                                        0
IRF7                                        0
ITK                                         0
JAK2                                        0
JAK3                                        0
KLRK1                                       0
LAG3                                        0
LAMP3                                       0
LILRA1                                      0
LILRB3                                      0
LYN                                         0
MCOLN2                                      0
P2RX7                                       0
PDCD1                                       0
PDCD1LG2                                    0
RELB                                        0
RIPK2                                       0
RNF19B                                      0
RSAD2                                       0
SERPING1                                    1
SIT1                                        0
SLAMF1                                      0
SLAMF6                                      0
SLAMF7                                      0
SLC11A1                                     0
TAP1                                        0
TAP2                                        0
TBX21                                       0
TLR8                                        0
TNFRSF11A                                   0
TNFRSF21                                    0
TNFSF13B                                    0
TNFSF18                                     0
ZC3H12A                                     0
CAMK2D                                      0
CIITA                                       0
GBP1                                        0
GBP2                                        0
MT2A                                        0
NLRC5                                       0
NMI                                         0
OAS2                                        0
PARP14                                      0
PML                                         0
SOCS1                                       0
STAT1                                       0
TRIM22                                      0
TRIM31                                      0
VCAM1                                       0
IFI27                                       0
IFI35                                       0
IFIT2                                       0
IFIT3                                       0
IFITM1                                      0
IFITM2                                      0
IFITM3                                      0
ISG20                                       0
PSMB8                                       0
STAT2                                       0
XAF1                                        0
ZBP1                                        0
TAPBP                                       0
AIM2                                        0
APOBEC3A                                    0
APOBEC3D                                    0
APOBEC3G                                    0
CXCL10                                      0
CXCL9                                       0
DDX60                                       0
DTX3L                                       0
GBP3                                        0
IFI44L                                      0
IFIH1                                       0
IFIT5                                       0
IL15                                        0
PMAIP1                                      0
RTP4                                        0
SERINC5                                     0
TLR7                                        0
TSPAN32                                     0
CCNE2                                       0
CDC45                                       0
CDC6                                        0
CDT1                                        0
MCM10                                       0
MCM2                                        0
MCM4                                        0
MCM5                                        0
MCM6                                        0
MCM7                                        0
ORC1                                        0
POLE2                                       0
TICRR                                       0
ACOD1                                       0
CALCOCO2                                    0
CCL13                                       0
CCL15                                       0
CCL18                                       0
CCL5                                        0
CCL7                                        0
CCL8                                        0
EDN1                                        0
GBP4                                        0
GBP5                                        0
GBP6                                        0
GBP7                                        0
GCH1                                        0
MEFV                                        0
NUB1                                        0
RAB20                                       0
UBD                                         0
ADAM8                                       0
ADGRE5                                      0
ADORA3                                      0
AGT                                         0
AOC3                                        0
APOL2                                       0
APOL3                                       0
APPL2                                       0
CASP4                                       0
CCRL2                                       0
CDH5                                        0
CFB                                         1
CFH                                         1
CR1L                                        1
CRHBP                                       0
CXCL11                                      0
CXCL5                                       0
CXCR3                                       0
CYLD                                        0
CYSLTR1                                     0
GGT5                                        0
GHRL                                        0
GSDMD                                       0
HGF                                         0
IDO1                                        0
IL1RN                                       0
IL22RA2                                     0
KARS1                                       0
KLF4                                        0
LRRK2                                       0
LY75                                        0
MMP25                                       0
MMP9                                        0
NLRP12                                      0
NOD2                                        0
OSM                                         0
POLB                                        0
PTGER4                                      0
SBNO2                                       0
SLAMF8                                      0
STAP1                                       0
SUCNR1                                      0
TGM2                                        0
TICAM2                                      0
TLR10                                       0
TLR5                                        0
TNFAIP6                                     0
BTN2A2                                      0
FYB1                                        0
PDE4B                                       0
PSMB10                                      0
PSMB9                                       0
PSME1                                       0
PSME2                                       0
APOL1                                       0
CD300LF                                     0
COLEC12                                     0
CX3CR1                                      0
FCN1                                        0
GRAMD4                                      0
H2BC21                                      0
ICAM2                                       0
LILRA2                                      0
MSRB1                                       0
MUC1                                        0
NCF1                                        0
OPTN                                        0
PYHIN1                                      0
TIFA                                        0
TRAFD1                                      0
GINS2                                       0
BATF2                                       0
CARD16                                      0
CARD17                                      0
CMPK2                                       0
LITAF                                       0
PADI2                                       0
KIF11                                       0
KIF15                                       0
KIF26A                                      0
          chemokine-mediated signaling pathway
B2M                                          0
BCL6                                         0
BTN3A1                                       0
BTN3A2                                       0
BTN3A3                                       0
C1QB                                         0
C1R                                          0
C1RL                                         0
C1S                                          0
C2                                           0
C3                                           0
C4A                                          0
C4B                                          0
CD1A                                         0
CD1C                                         0
CD274                                        0
CD28                                         0
CD40                                         0
CD7                                          0
CD74                                         0
CD80                                         0
CEACAM1                                      0
CLEC10A                                      0
CLEC6A                                       0
CTLA4                                        0
CTSS                                         0
ERAP2                                        0
EXO1                                         0
FGL1                                         0
FGL2                                         0
GCNT3                                        0
GPR183                                       0
HLA-A                                        0
HLA-B                                        0
HLA-C                                        0
HLA-DMA                                      0
HLA-DMB                                      0
HLA-DOA                                      0
HLA-DOB                                      0
HLA-DPA1                                     0
HLA-DPB1                                     0
HLA-DQA1                                     0
HLA-DQB1                                     0
HLA-DQB2                                     0
HLA-DRA                                      0
HLA-DRB1                                     0
HLA-DRB5                                     0
HLA-E                                        0
HLA-F                                        0
HLA-G                                        0
ICAM1                                        0
IL12A                                        0
IL12RB1                                      0
IL18BP                                       0
IL27                                         0
IRF1                                         0
IRF7                                         0
ITK                                          0
JAK2                                         0
JAK3                                         0
KLRK1                                        0
LAG3                                         0
LAMP3                                        0
LILRA1                                       0
LILRB3                                       0
LYN                                          0
MCOLN2                                       0
P2RX7                                        0
PDCD1                                        0
PDCD1LG2                                     0
RELB                                         0
RIPK2                                        0
RNF19B                                       0
RSAD2                                        0
SERPING1                                     0
SIT1                                         0
SLAMF1                                       0
SLAMF6                                       0
SLAMF7                                       0
SLC11A1                                      0
TAP1                                         0
TAP2                                         0
TBX21                                        0
TLR8                                         0
TNFRSF11A                                    0
TNFRSF21                                     0
TNFSF13B                                     0
TNFSF18                                      0
ZC3H12A                                      0
CAMK2D                                       0
CIITA                                        0
GBP1                                         0
GBP2                                         0
MT2A                                         0
NLRC5                                        0
NMI                                          0
OAS2                                         0
PARP14                                       0
PML                                          0
SOCS1                                        0
STAT1                                        0
TRIM22                                       0
TRIM31                                       0
VCAM1                                        0
IFI27                                        0
IFI35                                        0
IFIT2                                        0
IFIT3                                        0
IFITM1                                       0
IFITM2                                       0
IFITM3                                       0
ISG20                                        0
PSMB8                                        0
STAT2                                        0
XAF1                                         0
ZBP1                                         0
TAPBP                                        0
AIM2                                         0
APOBEC3A                                     0
APOBEC3D                                     0
APOBEC3G                                     0
CXCL10                                       1
CXCL9                                        1
DDX60                                        0
DTX3L                                        0
GBP3                                         0
IFI44L                                       0
IFIH1                                        0
IFIT5                                        0
IL15                                         0
PMAIP1                                       0
RTP4                                         0
SERINC5                                      0
TLR7                                         0
TSPAN32                                      0
CCNE2                                        0
CDC45                                        0
CDC6                                         0
CDT1                                         0
MCM10                                        0
MCM2                                         0
MCM4                                         0
MCM5                                         0
MCM6                                         0
MCM7                                         0
ORC1                                         0
POLE2                                        0
TICRR                                        0
ACOD1                                        0
CALCOCO2                                     0
CCL13                                        1
CCL15                                        1
CCL18                                        1
CCL5                                         1
CCL7                                         1
CCL8                                         1
EDN1                                         1
GBP4                                         0
GBP5                                         0
GBP6                                         0
GBP7                                         0
GCH1                                         0
MEFV                                         0
NUB1                                         0
RAB20                                        0
UBD                                          0
ADAM8                                        0
ADGRE5                                       0
ADORA3                                       0
AGT                                          0
AOC3                                         0
APOL2                                        0
APOL3                                        0
APPL2                                        0
CASP4                                        0
CCRL2                                        1
CDH5                                         0
CFB                                          0
CFH                                          0
CR1L                                         0
CRHBP                                        0
CXCL11                                       1
CXCL5                                        1
CXCR3                                        1
CYLD                                         0
CYSLTR1                                      0
GGT5                                         0
GHRL                                         0
GSDMD                                        0
HGF                                          0
IDO1                                         0
IL1RN                                        0
IL22RA2                                      0
KARS1                                        0
KLF4                                         0
LRRK2                                        0
LY75                                         0
MMP25                                        0
MMP9                                         0
NLRP12                                       0
NOD2                                         0
OSM                                          0
POLB                                         0
PTGER4                                       0
SBNO2                                        0
SLAMF8                                       0
STAP1                                        0
SUCNR1                                       0
TGM2                                         0
TICAM2                                       0
TLR10                                        0
TLR5                                         0
TNFAIP6                                      0
BTN2A2                                       0
FYB1                                         0
PDE4B                                        0
PSMB10                                       0
PSMB9                                        0
PSME1                                        0
PSME2                                        0
APOL1                                        0
CD300LF                                      0
COLEC12                                      0
CX3CR1                                       1
FCN1                                         0
GRAMD4                                       0
H2BC21                                       0
ICAM2                                        0
LILRA2                                       0
MSRB1                                        0
MUC1                                         0
NCF1                                         0
OPTN                                         0
PYHIN1                                       0
TIFA                                         0
TRAFD1                                       0
GINS2                                        0
BATF2                                        0
CARD16                                       0
CARD17                                       0
CMPK2                                        0
LITAF                                        0
PADI2                                        1
KIF11                                        0
KIF15                                        0
KIF26A                                       0
          antigen processing and presentation of exogenous peptide antigen via MHC class I, TAP-dependent
B2M                                                                                                     1
BCL6                                                                                                    0
BTN3A1                                                                                                  0
BTN3A2                                                                                                  0
BTN3A3                                                                                                  0
C1QB                                                                                                    0
C1R                                                                                                     0
C1RL                                                                                                    0
C1S                                                                                                     0
C2                                                                                                      0
C3                                                                                                      0
C4A                                                                                                     0
C4B                                                                                                     0
CD1A                                                                                                    0
CD1C                                                                                                    0
CD274                                                                                                   0
CD28                                                                                                    0
CD40                                                                                                    0
CD7                                                                                                     0
CD74                                                                                                    0
CD80                                                                                                    0
CEACAM1                                                                                                 0
CLEC10A                                                                                                 0
CLEC6A                                                                                                  0
CTLA4                                                                                                   0
CTSS                                                                                                    0
ERAP2                                                                                                   0
EXO1                                                                                                    0
FGL1                                                                                                    0
FGL2                                                                                                    0
GCNT3                                                                                                   0
GPR183                                                                                                  0
HLA-A                                                                                                   1
HLA-B                                                                                                   1
HLA-C                                                                                                   1
HLA-DMA                                                                                                 0
HLA-DMB                                                                                                 0
HLA-DOA                                                                                                 0
HLA-DOB                                                                                                 0
HLA-DPA1                                                                                                0
HLA-DPB1                                                                                                0
HLA-DQA1                                                                                                0
HLA-DQB1                                                                                                0
HLA-DQB2                                                                                                0
HLA-DRA                                                                                                 0
HLA-DRB1                                                                                                0
HLA-DRB5                                                                                                0
HLA-E                                                                                                   1
HLA-F                                                                                                   1
HLA-G                                                                                                   1
ICAM1                                                                                                   0
IL12A                                                                                                   0
IL12RB1                                                                                                 0
IL18BP                                                                                                  0
IL27                                                                                                    0
IRF1                                                                                                    0
IRF7                                                                                                    0
ITK                                                                                                     0
JAK2                                                                                                    0
JAK3                                                                                                    0
KLRK1                                                                                                   0
LAG3                                                                                                    0
LAMP3                                                                                                   0
LILRA1                                                                                                  0
LILRB3                                                                                                  0
LYN                                                                                                     0
MCOLN2                                                                                                  0
P2RX7                                                                                                   0
PDCD1                                                                                                   0
PDCD1LG2                                                                                                0
RELB                                                                                                    0
RIPK2                                                                                                   0
RNF19B                                                                                                  0
RSAD2                                                                                                   0
SERPING1                                                                                                0
SIT1                                                                                                    0
SLAMF1                                                                                                  0
SLAMF6                                                                                                  0
SLAMF7                                                                                                  0
SLC11A1                                                                                                 0
TAP1                                                                                                    1
TAP2                                                                                                    1
TBX21                                                                                                   0
TLR8                                                                                                    0
TNFRSF11A                                                                                               0
TNFRSF21                                                                                                0
TNFSF13B                                                                                                0
TNFSF18                                                                                                 0
ZC3H12A                                                                                                 0
CAMK2D                                                                                                  0
CIITA                                                                                                   0
GBP1                                                                                                    0
GBP2                                                                                                    0
MT2A                                                                                                    0
NLRC5                                                                                                   0
NMI                                                                                                     0
OAS2                                                                                                    0
PARP14                                                                                                  0
PML                                                                                                     0
SOCS1                                                                                                   0
STAT1                                                                                                   0
TRIM22                                                                                                  0
TRIM31                                                                                                  0
VCAM1                                                                                                   0
IFI27                                                                                                   0
IFI35                                                                                                   0
IFIT2                                                                                                   0
IFIT3                                                                                                   0
IFITM1                                                                                                  0
IFITM2                                                                                                  0
IFITM3                                                                                                  0
ISG20                                                                                                   0
PSMB8                                                                                                   1
STAT2                                                                                                   0
XAF1                                                                                                    0
ZBP1                                                                                                    0
TAPBP                                                                                                   1
AIM2                                                                                                    0
APOBEC3A                                                                                                0
APOBEC3D                                                                                                0
APOBEC3G                                                                                                0
CXCL10                                                                                                  0
CXCL9                                                                                                   0
DDX60                                                                                                   0
DTX3L                                                                                                   0
GBP3                                                                                                    0
IFI44L                                                                                                  0
IFIH1                                                                                                   0
IFIT5                                                                                                   0
IL15                                                                                                    0
PMAIP1                                                                                                  0
RTP4                                                                                                    0
SERINC5                                                                                                 0
TLR7                                                                                                    0
TSPAN32                                                                                                 0
CCNE2                                                                                                   0
CDC45                                                                                                   0
CDC6                                                                                                    0
CDT1                                                                                                    0
MCM10                                                                                                   0
MCM2                                                                                                    0
MCM4                                                                                                    0
MCM5                                                                                                    0
MCM6                                                                                                    0
MCM7                                                                                                    0
ORC1                                                                                                    0
POLE2                                                                                                   0
TICRR                                                                                                   0
ACOD1                                                                                                   0
CALCOCO2                                                                                                0
CCL13                                                                                                   0
CCL15                                                                                                   0
CCL18                                                                                                   0
CCL5                                                                                                    0
CCL7                                                                                                    0
CCL8                                                                                                    0
EDN1                                                                                                    0
GBP4                                                                                                    0
GBP5                                                                                                    0
GBP6                                                                                                    0
GBP7                                                                                                    0
GCH1                                                                                                    0
MEFV                                                                                                    0
NUB1                                                                                                    0
RAB20                                                                                                   0
UBD                                                                                                     0
ADAM8                                                                                                   0
ADGRE5                                                                                                  0
ADORA3                                                                                                  0
AGT                                                                                                     0
AOC3                                                                                                    0
APOL2                                                                                                   0
APOL3                                                                                                   0
APPL2                                                                                                   0
CASP4                                                                                                   0
CCRL2                                                                                                   0
CDH5                                                                                                    0
CFB                                                                                                     0
CFH                                                                                                     0
CR1L                                                                                                    0
CRHBP                                                                                                   0
CXCL11                                                                                                  0
CXCL5                                                                                                   0
CXCR3                                                                                                   0
CYLD                                                                                                    0
CYSLTR1                                                                                                 0
GGT5                                                                                                    0
GHRL                                                                                                    0
GSDMD                                                                                                   0
HGF                                                                                                     0
IDO1                                                                                                    0
IL1RN                                                                                                   0
IL22RA2                                                                                                 0
KARS1                                                                                                   0
KLF4                                                                                                    0
LRRK2                                                                                                   0
LY75                                                                                                    0
MMP25                                                                                                   0
MMP9                                                                                                    0
NLRP12                                                                                                  0
NOD2                                                                                                    0
OSM                                                                                                     0
POLB                                                                                                    0
PTGER4                                                                                                  0
SBNO2                                                                                                   0
SLAMF8                                                                                                  0
STAP1                                                                                                   0
SUCNR1                                                                                                  0
TGM2                                                                                                    0
TICAM2                                                                                                  0
TLR10                                                                                                   0
TLR5                                                                                                    0
TNFAIP6                                                                                                 0
BTN2A2                                                                                                  0
FYB1                                                                                                    0
PDE4B                                                                                                   0
PSMB10                                                                                                  1
PSMB9                                                                                                   1
PSME1                                                                                                   1
PSME2                                                                                                   1
APOL1                                                                                                   0
CD300LF                                                                                                 0
COLEC12                                                                                                 0
CX3CR1                                                                                                  0
FCN1                                                                                                    0
GRAMD4                                                                                                  0
H2BC21                                                                                                  0
ICAM2                                                                                                   0
LILRA2                                                                                                  0
MSRB1                                                                                                   0
MUC1                                                                                                    0
NCF1                                                                                                    1
OPTN                                                                                                    0
PYHIN1                                                                                                  0
TIFA                                                                                                    0
TRAFD1                                                                                                  0
GINS2                                                                                                   0
BATF2                                                                                                   0
CARD16                                                                                                  0
CARD17                                                                                                  0
CMPK2                                                                                                   0
LITAF                                                                                                   0
PADI2                                                                                                   0
KIF11                                                                                                   0
KIF15                                                                                                   0
KIF26A                                                                                                  0
          antigen processing and presentation of exogenous peptide antigen via MHC class II
B2M                                                                                       0
BCL6                                                                                      0
BTN3A1                                                                                    0
BTN3A2                                                                                    0
BTN3A3                                                                                    0
C1QB                                                                                      0
C1R                                                                                       0
C1RL                                                                                      0
C1S                                                                                       0
C2                                                                                        0
C3                                                                                        0
C4A                                                                                       0
C4B                                                                                       0
CD1A                                                                                      0
CD1C                                                                                      0
CD274                                                                                     0
CD28                                                                                      0
CD40                                                                                      0
CD7                                                                                       0
CD74                                                                                      1
CD80                                                                                      0
CEACAM1                                                                                   0
CLEC10A                                                                                   0
CLEC6A                                                                                    0
CTLA4                                                                                     0
CTSS                                                                                      1
ERAP2                                                                                     0
EXO1                                                                                      0
FGL1                                                                                      0
FGL2                                                                                      0
GCNT3                                                                                     0
GPR183                                                                                    0
HLA-A                                                                                     0
HLA-B                                                                                     0
HLA-C                                                                                     0
HLA-DMA                                                                                   1
HLA-DMB                                                                                   1
HLA-DOA                                                                                   1
HLA-DOB                                                                                   1
HLA-DPA1                                                                                  1
HLA-DPB1                                                                                  1
HLA-DQA1                                                                                  1
HLA-DQB1                                                                                  1
HLA-DQB2                                                                                  1
HLA-DRA                                                                                   1
HLA-DRB1                                                                                  1
HLA-DRB5                                                                                  1
HLA-E                                                                                     0
HLA-F                                                                                     0
HLA-G                                                                                     0
ICAM1                                                                                     0
IL12A                                                                                     0
IL12RB1                                                                                   0
IL18BP                                                                                    0
IL27                                                                                      0
IRF1                                                                                      0
IRF7                                                                                      0
ITK                                                                                       0
JAK2                                                                                      0
JAK3                                                                                      0
KLRK1                                                                                     0
LAG3                                                                                      1
LAMP3                                                                                     0
LILRA1                                                                                    0
LILRB3                                                                                    0
LYN                                                                                       0
MCOLN2                                                                                    0
P2RX7                                                                                     0
PDCD1                                                                                     0
PDCD1LG2                                                                                  0
RELB                                                                                      0
RIPK2                                                                                     0
RNF19B                                                                                    0
RSAD2                                                                                     0
SERPING1                                                                                  0
SIT1                                                                                      0
SLAMF1                                                                                    0
SLAMF6                                                                                    0
SLAMF7                                                                                    0
SLC11A1                                                                                   0
TAP1                                                                                      0
TAP2                                                                                      0
TBX21                                                                                     0
TLR8                                                                                      0
TNFRSF11A                                                                                 0
TNFRSF21                                                                                  0
TNFSF13B                                                                                  0
TNFSF18                                                                                   0
ZC3H12A                                                                                   0
CAMK2D                                                                                    0
CIITA                                                                                     0
GBP1                                                                                      0
GBP2                                                                                      0
MT2A                                                                                      0
NLRC5                                                                                     0
NMI                                                                                       0
OAS2                                                                                      0
PARP14                                                                                    0
PML                                                                                       0
SOCS1                                                                                     0
STAT1                                                                                     0
TRIM22                                                                                    0
TRIM31                                                                                    0
VCAM1                                                                                     0
IFI27                                                                                     0
IFI35                                                                                     0
IFIT2                                                                                     0
IFIT3                                                                                     0
IFITM1                                                                                    0
IFITM2                                                                                    0
IFITM3                                                                                    0
ISG20                                                                                     0
PSMB8                                                                                     0
STAT2                                                                                     0
XAF1                                                                                      0
ZBP1                                                                                      0
TAPBP                                                                                     0
AIM2                                                                                      0
APOBEC3A                                                                                  0
APOBEC3D                                                                                  0
APOBEC3G                                                                                  0
CXCL10                                                                                    0
CXCL9                                                                                     0
DDX60                                                                                     0
DTX3L                                                                                     0
GBP3                                                                                      0
IFI44L                                                                                    0
IFIH1                                                                                     0
IFIT5                                                                                     0
IL15                                                                                      0
PMAIP1                                                                                    0
RTP4                                                                                      0
SERINC5                                                                                   0
TLR7                                                                                      0
TSPAN32                                                                                   0
CCNE2                                                                                     0
CDC45                                                                                     0
CDC6                                                                                      0
CDT1                                                                                      0
MCM10                                                                                     0
MCM2                                                                                      0
MCM4                                                                                      0
MCM5                                                                                      0
MCM6                                                                                      0
MCM7                                                                                      0
ORC1                                                                                      0
POLE2                                                                                     0
TICRR                                                                                     0
ACOD1                                                                                     0
CALCOCO2                                                                                  0
CCL13                                                                                     0
CCL15                                                                                     0
CCL18                                                                                     0
CCL5                                                                                      0
CCL7                                                                                      0
CCL8                                                                                      0
EDN1                                                                                      0
GBP4                                                                                      0
GBP5                                                                                      0
GBP6                                                                                      0
GBP7                                                                                      0
GCH1                                                                                      0
MEFV                                                                                      0
NUB1                                                                                      0
RAB20                                                                                     0
UBD                                                                                       0
ADAM8                                                                                     0
ADGRE5                                                                                    0
ADORA3                                                                                    0
AGT                                                                                       0
AOC3                                                                                      0
APOL2                                                                                     0
APOL3                                                                                     0
APPL2                                                                                     0
CASP4                                                                                     0
CCRL2                                                                                     0
CDH5                                                                                      0
CFB                                                                                       0
CFH                                                                                       0
CR1L                                                                                      0
CRHBP                                                                                     0
CXCL11                                                                                    0
CXCL5                                                                                     0
CXCR3                                                                                     0
CYLD                                                                                      0
CYSLTR1                                                                                   0
GGT5                                                                                      0
GHRL                                                                                      0
GSDMD                                                                                     0
HGF                                                                                       0
IDO1                                                                                      0
IL1RN                                                                                     0
IL22RA2                                                                                   0
KARS1                                                                                     0
KLF4                                                                                      0
LRRK2                                                                                     0
LY75                                                                                      0
MMP25                                                                                     0
MMP9                                                                                      0
NLRP12                                                                                    0
NOD2                                                                                      0
OSM                                                                                       0
POLB                                                                                      0
PTGER4                                                                                    0
SBNO2                                                                                     0
SLAMF8                                                                                    0
STAP1                                                                                     0
SUCNR1                                                                                    0
TGM2                                                                                      0
TICAM2                                                                                    0
TLR10                                                                                     0
TLR5                                                                                      0
TNFAIP6                                                                                   0
BTN2A2                                                                                    0
FYB1                                                                                      0
PDE4B                                                                                     0
PSMB10                                                                                    0
PSMB9                                                                                     0
PSME1                                                                                     0
PSME2                                                                                     0
APOL1                                                                                     0
CD300LF                                                                                   0
COLEC12                                                                                   0
CX3CR1                                                                                    0
FCN1                                                                                      0
GRAMD4                                                                                    0
H2BC21                                                                                    0
ICAM2                                                                                     0
LILRA2                                                                                    0
MSRB1                                                                                     0
MUC1                                                                                      0
NCF1                                                                                      0
OPTN                                                                                      0
PYHIN1                                                                                    0
TIFA                                                                                      0
TRAFD1                                                                                    0
GINS2                                                                                     0
BATF2                                                                                     0
CARD16                                                                                    0
CARD17                                                                                    0
CMPK2                                                                                     0
LITAF                                                                                     0
PADI2                                                                                     0
KIF11                                                                                     1
KIF15                                                                                     1
KIF26A                                                                                    1
> dim(create_upsetdata(res_enrich[1:20, ]))
[1] 246  20
> 
> create_upsetdata(res_enrich[1:5, ], use_ids = TRUE)
          GO:0002250 GO:0060333 GO:0060337 GO:0019885 GO:0051607
B2M                1          1          0          1          0
BCL6               1          0          0          0          0
BTN3A1             1          0          0          0          0
BTN3A2             1          0          0          0          0
BTN3A3             1          0          0          0          0
C1QB               1          0          0          0          0
C1R                1          0          0          0          0
C1RL               1          0          0          0          0
C1S                1          0          0          0          0
C2                 1          0          0          0          0
C3                 1          0          0          0          0
C4A                1          0          0          0          0
C4B                1          0          0          0          0
CD1A               1          0          0          0          0
CD1C               1          0          0          0          0
CD274              1          0          0          0          0
CD28               1          0          0          0          0
CD40               1          0          0          0          1
CD7                1          0          0          0          0
CD74               1          0          0          0          0
CD80               1          0          0          0          0
CEACAM1            1          0          0          0          0
CLEC10A            1          0          0          0          0
CLEC6A             1          0          0          0          0
CTLA4              1          0          0          0          0
CTSS               1          0          0          0          0
ERAP2              1          0          0          1          0
EXO1               1          0          0          0          0
FGL1               1          0          0          0          0
FGL2               1          0          0          0          1
GCNT3              1          0          0          0          0
GPR183             1          0          0          0          0
HLA-A              1          1          1          1          0
HLA-B              1          1          1          1          0
HLA-C              1          1          1          1          0
HLA-DMA            1          0          0          0          0
HLA-DMB            1          0          0          0          0
HLA-DOA            1          0          0          0          0
HLA-DOB            1          0          0          0          0
HLA-DPA1           1          1          0          0          0
HLA-DPB1           1          1          0          0          0
HLA-DQA1           1          1          0          0          0
HLA-DQB1           1          1          0          0          0
HLA-DQB2           1          1          0          0          0
HLA-DRA            1          1          0          0          0
HLA-DRB1           1          1          0          0          0
HLA-DRB5           1          1          0          0          0
HLA-E              1          1          1          1          0
HLA-F              1          1          1          1          0
HLA-G              1          1          1          1          0
ICAM1              1          1          0          0          0
IL12A              1          0          0          0          0
IL12RB1            1          0          0          0          1
IL18BP             1          0          0          0          0
IL27               1          0          0          0          1
IRF1               1          1          1          0          1
IRF7               1          1          1          0          1
ITK                1          0          0          0          0
JAK2               1          1          0          0          0
JAK3               1          0          0          0          0
KLRK1              1          0          0          0          0
LAG3               1          0          0          0          0
LAMP3              1          0          0          0          0
LILRA1             1          0          0          0          0
LILRB3             1          0          0          0          0
LYN                1          0          0          0          0
MCOLN2             1          0          0          0          0
P2RX7              1          0          0          0          0
PDCD1              1          0          0          0          0
PDCD1LG2           1          0          0          0          0
RELB               1          0          0          0          0
RIPK2              1          0          0          0          0
RNF19B             1          0          0          0          0
RSAD2              1          0          1          0          1
SERPING1           1          0          0          0          0
SIT1               1          0          0          0          0
SLAMF1             1          0          0          0          0
SLAMF6             1          0          0          0          0
SLAMF7             1          0          0          0          0
SLC11A1            1          0          0          0          0
TAP1               1          0          0          1          0
TAP2               1          0          0          1          0
TBX21              1          0          0          0          0
TLR8               1          0          0          0          1
TNFRSF11A          1          0          0          0          0
TNFRSF21           1          0          0          0          0
TNFSF13B           1          0          0          0          0
TNFSF18            1          0          0          0          0
ZC3H12A            1          0          0          0          1
CAMK2D             0          1          0          0          0
CIITA              0          1          0          0          0
GBP1               0          1          0          0          1
GBP2               0          1          1          0          0
MT2A               0          1          0          0          0
NLRC5              0          1          1          0          1
NMI                0          1          0          0          0
OAS2               0          1          1          0          1
PARP14             0          1          0          0          0
PML                0          1          0          0          1
SOCS1              0          1          0          0          0
STAT1              0          1          1          0          1
TRIM22             0          1          0          0          1
TRIM31             0          1          0          0          0
VCAM1              0          1          0          0          0
IFI27              0          0          1          0          1
IFI35              0          0          1          0          0
IFIT2              0          0          1          0          1
IFIT3              0          0          1          0          1
IFITM1             0          0          1          0          1
IFITM2             0          0          1          0          1
IFITM3             0          0          1          0          1
ISG20              0          0          1          0          1
PSMB8              0          0          1          0          0
STAT2              0          0          1          0          1
XAF1               0          0          1          0          0
ZBP1               0          0          1          0          0
TAPBP              0          0          0          1          0
AIM2               0          0          0          0          1
APOBEC3A           0          0          0          0          1
APOBEC3D           0          0          0          0          1
APOBEC3G           0          0          0          0          1
CXCL10             0          0          0          0          1
CXCL9              0          0          0          0          1
DDX60              0          0          0          0          1
DTX3L              0          0          0          0          1
GBP3               0          0          0          0          1
IFI44L             0          0          0          0          1
IFIH1              0          0          0          0          1
IFIT5              0          0          0          0          1
IL15               0          0          0          0          1
PMAIP1             0          0          0          0          1
RTP4               0          0          0          0          1
SERINC5            0          0          0          0          1
TLR7               0          0          0          0          1
TSPAN32            0          0          0          0          1
> 
> 
> 
> cleanEx()
> nameEx("deseqresult2df")
> ### * deseqresult2df
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: deseqresult2df
> ### Title: Generate a table from the 'DESeq2' results
> ### Aliases: deseqresult2df
> 
> ### ** Examples
> 
> data(res_de_macrophage, package = "GeneTonic")
> head(res_macrophage_IFNg_vs_naive)
log2 fold change (MLE): condition IFNg vs naive 
Wald test p-value: condition IFNg vs naive 
DataFrame with 6 rows and 7 columns
                 baseMean log2FoldChange     lfcSE      stat      pvalue
                <numeric>      <numeric> <numeric> <numeric>   <numeric>
ENSG00000000003   171.571     -0.2822450 0.3005710   0.00000 1.00000e+00
ENSG00000000419   967.751      0.0391223 0.0859708   0.00000 1.00000e+00
ENSG00000000457   682.433      1.2846179 0.1969067   1.44545 1.48333e-01
ENSG00000000460   262.963     -1.4718762 0.2186916  -2.15772 3.09493e-02
ENSG00000000938  2660.102      0.6754781 0.2360530   0.00000 1.00000e+00
ENSG00000000971  3052.123      4.9871107 0.4964284   8.03159 9.62155e-16
                       padj      SYMBOL
                  <numeric> <character>
ENSG00000000003 1.00000e+00      TSPAN6
ENSG00000000419 1.00000e+00        DPM1
ENSG00000000457 1.00000e+00       SCYL3
ENSG00000000460 4.09728e-01    C1orf112
ENSG00000000938 1.00000e+00         FGR
ENSG00000000971 1.37057e-13         CFH
> res_df <- deseqresult2df(res_macrophage_IFNg_vs_naive)
> head(res_df)
                             id   baseMean log2FoldChange     lfcSE     stat
ENSG00000125347 ENSG00000125347 30585.0749       5.560124 0.2182663 20.89248
ENSG00000162645 ENSG00000162645 36790.5921       6.665804 0.2865732 19.77088
ENSG00000111181 ENSG00000111181   688.5779       4.710592 0.1961023 18.92172
ENSG00000174944 ENSG00000174944  1324.3975       9.863904 0.4715127 18.79886
ENSG00000100336 ENSG00000100336  2551.4789       8.708551 0.4214096 18.29230
ENSG00000145365 ENSG00000145365  3637.2221       5.193448 0.2368542 17.70476
                      pvalue         padj  SYMBOL
ENSG00000125347 6.268470e-97 1.116164e-92    IRF1
ENSG00000162645 5.304222e-87 4.722349e-83    GBP2
ENSG00000111181 7.555181e-80 4.484252e-76 SLC6A12
ENSG00000174944 7.715124e-79 3.434388e-75  P2RY14
ENSG00000100336 9.530829e-75 3.394119e-71   APOL4
ENSG00000145365 3.853076e-70 1.143465e-66    TIFA
> 
> 
> 
> cleanEx()
> nameEx("distill_enrichment")
> ### * distill_enrichment
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: distill_enrichment
> ### Title: Distill enrichment results
> ### Aliases: distill_enrichment
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> distilled <- distill_enrichment(res_enrich,
+   res_de,
+   annotation_obj,
+   n_gs = 100,
+   cluster_fun = "cluster_markov"
+ )
> colnames(distilled$distilled_table)
[1] "metags_cluster"    "metags_n_gs"       "metags_genes"     
[4] "metags_n_genes"    "metags_gsidlist"   "metags_gsdesclist"
[7] "metags_msgs"       "metags_mcgs"      
> distilled$distilled_em
IGRAPH b85b27e UN-- 100 553 -- 
+ attr: name (v/c), size (v/n), original_size (v/n), color.background
| (v/c), color.highlight (v/c), color.hover (v/c), color.border (v/c),
| membership (v/n), color (v/n), width (e/n), color (e/c)
+ edges from b85b27e (vertex names):
[1] adaptive immune response--interferon-gamma-mediated signaling pathway                                      
[2] adaptive immune response--antigen processing and presentation of endogenous peptide antigen via MHC class I
[3] adaptive immune response--positive regulation of T cell mediated cytotoxicity                              
[4] adaptive immune response--antigen processing and presentation via MHC class Ib                             
+ ... omitted several edges
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("enhance_table")
> ### * enhance_table
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: enhance_table
> ### Title: Visually enhances a functional enrichment result table
> ### Aliases: enhance_table
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> enhance_table(res_enrich,
+   res_de,
+   anno_df,
+   n_gs = 10
+ )
> 
> # using the ridge line as a style, also coloring by the Z score
> res_enrich_withscores <- get_aggrscores(
+   res_enrich,
+   res_de,
+   anno_df
+ )
> enhance_table(res_enrich_withscores,
+   res_de,
+   anno_df,
+   n_gs = 10, 
+   plot_style = "ridgeline",
+   ridge_color = "gs_score"
+ )
Picking joint bandwidth of 0.553
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("enrichment_map")
> ### * enrichment_map
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: enrichment_map
> ### Title: Creates an enrichment map for the results of functional
> ###   enrichment
> ### Aliases: enrichment_map
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> em <- enrichment_map(res_enrich,
+   res_de,
+   anno_df,
+   n_gs = 20
+ )
> 
> em
IGRAPH 65b4602 UN-- 20 54 -- 
+ attr: name (v/c), size (v/n), original_size (v/n), color.background
| (v/c), color.highlight (v/c), color.hover (v/c), color.border (v/c),
| width (e/n), color (e/c)
+ edges from 65b4602 (vertex names):
[1] adaptive immune response--interferon-gamma-mediated signaling pathway                                      
[2] adaptive immune response--antigen processing and presentation of endogenous peptide antigen via MHC class I
[3] adaptive immune response--positive regulation of T cell mediated cytotoxicity                              
[4] adaptive immune response--antigen processing and presentation via MHC class Ib                             
+ ... omitted several edges
> 
> # could be viewed interactively with
> # library("visNetwork")
> # library("magrittr")
> # em %>%
> #   visIgraph() %>%
> #   visOptions(highlightNearest = list(enabled = TRUE,
> #                                      degree = 1,
> #                                      hover = TRUE),
> #             nodesIdSelection = TRUE)
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("export_for_iSEE")
> ### * export_for_iSEE
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: export_for_iSEE
> ### Title: export_for_iSEE
> ### Aliases: export_for_iSEE
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # now everything is in place to launch the app
> # dds_macrophage <- DESeq2::DESeq(dds_macrophage)
> se_macrophage <- export_for_iSEE(dds_macrophage, res_de)
Attempting to combine a dds and a res_de object where not allidentifiers are shared. Subsetting to the intersection of these...
> # iSEE(se_macrophage)
> 
> 
> 
> cleanEx()

detaching ‘package:DESeq2’, ‘package:SummarizedExperiment’,
  ‘package:Biobase’, ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("export_to_sif")
> ### * export_to_sif
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: export_to_sif
> ### Title: Export to sif
> ### Aliases: export_to_sif
> 
> ### ** Examples
> 
> library("igraph")

Attaching package: ‘igraph’

The following objects are masked from ‘package:stats’:

    decompose, spectrum

The following object is masked from ‘package:base’:

    union

> g <- make_full_graph(5) %du% make_full_graph(5) %du% make_full_graph(5)
> g <- add_edges(g, c(1, 6, 1, 11, 6, 11))
> export_to_sif(g, tempfile())
Saving the file to /var/folders/l4/yqkcxkkj07jccl06ptwvsnfh0000gn/T//RtmphBkjTs/filee9bd6a436b4e
Done!
> 
> 
> 
> cleanEx()

detaching ‘package:igraph’

> nameEx("gene_plot")
> ### * gene_plot
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gene_plot
> ### Title: Plot expression values for a gene
> ### Aliases: gene_plot
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> gene_plot(dds_macrophage,
+   gene = "ENSG00000125347",
+   intgroup = "condition",
+   annotation_obj = anno_df
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("geneinfo_2_html")
> ### * geneinfo_2_html
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: geneinfo_2_html
> ### Title: Information on a gene
> ### Aliases: geneinfo_2_html
> 
> ### ** Examples
> 
> geneinfo_2_html("ACTB")
<b>ACTB</b><br/>Link to the NCBI Gene database: <a href = "http://www.ncbi.nlm.nih.gov/gene/?term=ACTB[sym]" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC">ACTB</a><br/>Link to the GeneCards database: <a href = "https://www.genecards.org/cgi-bin/carddisp.pl?gene=ACTB" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC">ACTB</a><br/>Link to the GTEx Portal: <a href = "https://www.gtexportal.org/home/gene/ACTB" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC"><i class="fa fa-dna"></i>ACTB</a><br/>
> geneinfo_2_html("Pf4")
<b>Pf4</b><br/>Link to the NCBI Gene database: <a href = "http://www.ncbi.nlm.nih.gov/gene/?term=Pf4[sym]" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC">Pf4</a><br/>Link to the GeneCards database: <a href = "https://www.genecards.org/cgi-bin/carddisp.pl?gene=Pf4" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC">Pf4</a><br/>Link to the GTEx Portal: <a href = "https://www.gtexportal.org/home/gene/Pf4" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC"><i class="fa fa-dna"></i>Pf4</a><br/>
> 
> 
> 
> cleanEx()
> nameEx("get_aggrscores")
> ### * get_aggrscores
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: get_aggrscores
> ### Title: Compute aggregated scores for gene sets
> ### Aliases: get_aggrscores
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> 
> res_enrich <- get_aggrscores(
+   res_enrich,
+   res_de,
+   anno_df
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("get_expression_values")
> ### * get_expression_values
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: get_expression_values
> ### Title: Get expression values
> ### Aliases: get_expression_values
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> df_exp <- get_expression_values(dds_macrophage,
+   gene = "ENSG00000125347",
+   intgroup = "condition"
+ )
> head(df_exp)
                exp_value   condition
SAMEA103885102   819.6422       naive
SAMEA103885347 31852.1503        IFNg
SAMEA103885043 17874.4499      SL1344
SAMEA103885392 71361.7711 IFNg_SL1344
SAMEA103885182  1239.2723       naive
SAMEA103885136 41985.4038        IFNg
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("ggs_backbone")
> ### * ggs_backbone
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ggs_backbone
> ### Title: Extract the backbone for the gene-geneset graph
> ### Aliases: ggs_backbone
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> ggs_bbg <- ggs_backbone(res_enrich,
+   res_de,
+   anno_df,
+   n_gs = 50,
+   bb_on = "genesets",
+   color_graph = TRUE,
+   color_by_geneset = "z_score"
+ )
> plot(ggs_bbg)
> 
> # if desired, one can also plot the interactive version
> visNetwork::visIgraph(ggs_bbg)
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("ggs_graph")
> ### * ggs_graph
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ggs_graph
> ### Title: Construct a gene-geneset-graph
> ### Aliases: ggs_graph
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> ggs <- ggs_graph(
+   res_enrich,
+   res_de,
+   anno_df
+ )
> 
> ggs
IGRAPH 86a457a UN-- 253 569 -- 
+ attr: name (v/c), nodetype (v/c), shape (v/c), color (v/c), title
| (v/c)
+ edges from 86a457a (vertex names):
 [1] adaptive immune response--B2M    adaptive immune response--BCL6  
 [3] adaptive immune response--BTN3A1 adaptive immune response--BTN3A2
 [5] adaptive immune response--BTN3A3 adaptive immune response--C1QB  
 [7] adaptive immune response--C1R    adaptive immune response--C1RL  
 [9] adaptive immune response--C1S    adaptive immune response--C2    
[11] adaptive immune response--C3     adaptive immune response--C4A   
[13] adaptive immune response--C4B    adaptive immune response--CD1A  
+ ... omitted several edges
> 
> #' # could be viewed interactively with
> # library(visNetwork)
> # library(magrittr)
> # ggs %>%
> #   visIgraph() %>%
> #   visOptions(highlightNearest = list(enabled = TRUE,
> #                                      degree = 1,
> #                                      hover = TRUE),
> #             nodesIdSelection = TRUE)
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("go_2_html")
> ### * go_2_html
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: go_2_html
> ### Title: Information on a GeneOntology identifier
> ### Aliases: go_2_html
> 
> ### ** Examples
> 
> go_2_html("GO:0002250")
<b>GO ID: </b><a href = "http://amigo.geneontology.org/amigo/term/GO:0002250" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC">GO:0002250</a><br/><b>Term: </b>adaptive immune response<br/><b>Ontology: </b>BP<br/><br/><b>Definition: </b>An immune response mediated by cells expressing specific receptors for antigens produced through a somatic diversification process, and allowing for an enhanced secondary response to subsequent exposures to the same antigen (immunological memory).<br/><b>Synonym: </b>acquired immune response<br/><b>Synonym: </b>immune memory response<br/>
> go_2_html("GO:0043368")
<b>GO ID: </b><a href = "http://amigo.geneontology.org/amigo/term/GO:0043368" target = "_blank" class = "btn btn-primary" style = "color: #ffffff; background-color: #0092AC">GO:0043368</a><br/><b>Term: </b>positive T cell selection<br/><b>Ontology: </b>BP<br/><br/><b>Definition: </b>The process of sparing immature T cells which react with self-MHC protein complexes with low affinity levels from apoptotic death.<br/><b>Synonym: </b>positive T lymphocyte selection<br/><b>Synonym: </b>positive T-cell selection<br/><b>Synonym: </b>positive T-lymphocyte selection<br/>
> 
> 
> 
> cleanEx()
> nameEx("gs_alluvial")
> ### * gs_alluvial
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_alluvial
> ### Title: Alluvial (sankey) plot for a set of genesets and the associated
> ###   genes
> ### Aliases: gs_alluvial gs_sankey
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_alluvial(
+   res_enrich = res_enrich,
+   res_de = res_de,
+   annotation_obj = anno_df,
+   n_gs = 4
+ )
> # or using the alias...
> gs_sankey(
+   res_enrich = res_enrich,
+   res_de = res_de,
+   annotation_obj = anno_df,
+   n_gs = 4
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_dendro")
> ### * gs_dendro
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_dendro
> ### Title: Dendrogram of the gene set enrichment results
> ### Aliases: gs_dendro
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_dendro(res_enrich,
+   n_gs = 100
+ )
Warning in RColorBrewer::brewer.pal(max(my.clusters), "Set1") :
  n too large, allowed maximum for palette Set1 is 9
Returning the palette you asked for with that many colors

Warning in branches_attr_by_clusters(my_dend, my.clusters[dend_idx], values = clust_pal) :
  Length of values vector was shorter than the number of clusters (Excluding 0) - vector was recycled
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_fuzzyclustering")
> ### * gs_fuzzyclustering
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_fuzzyclustering
> ### Title: Compute fuzzy clusters of gene sets
> ### Aliases: gs_fuzzyclustering
> 
> ### ** Examples
> 
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> # taking a smaller subset
> res_enrich_subset <- res_enrich[1:100, ]
> 
> fuzzy_subset <- gs_fuzzyclustering(
+   res_enrich = res_enrich_subset,
+   n_gs = nrow(res_enrich_subset),
+   gs_ids = NULL,
+   similarity_matrix = NULL,
+   similarity_threshold = 0.35,
+   fuzzy_seeding_initial_neighbors = 3,
+   fuzzy_multilinkage_rule = 0.5
+ )
> 
> # show all genesets members of the first cluster
> fuzzy_subset[fuzzy_subset$gs_fuzzycluster == "1", ]
                gs_id                              gs_description gs_pvalue
GO:0060333 GO:0060333 interferon-gamma-mediated signaling pathway   1.2e-20
GO:0060337 GO:0060337         type I interferon signaling pathway   4.8e-13
GO:0034341 GO:0034341                response to interferon-gamma   2.2e-08
GO:0045087 GO:0045087                      innate immune response   1.1e-07
GO:0071346 GO:0071346       cellular response to interferon-gamma   8.5e-06
GO:0019221 GO:0019221         cytokine-mediated signaling pathway   7.4e-04
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        gs_genes
GO:0060333                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             B2M,CAMK2D,CIITA,GBP1,GBP2,HLA-A,HLA-B,HLA-C,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,IRF1,IRF7,JAK2,MT2A,NLRC5,NMI,OAS2,PARP14,PML,SOCS1,STAT1,TRIM22,TRIM31,VCAM1
GO:0060337                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    GBP2,HLA-A,HLA-B,HLA-C,HLA-E,HLA-F,HLA-G,IFI27,IFI35,IFIT2,IFIT3,IFITM1,IFITM2,IFITM3,IRF1,IRF7,ISG20,NLRC5,OAS2,PSMB8,RSAD2,STAT1,STAT2,XAF1,ZBP1
GO:0034341                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ACOD1,B2M,CALCOCO2,CAMK2D,CCL13,CCL15,CCL18,CCL5,CCL7,CCL8,CIITA,EDN1,GBP1,GBP2,GBP3,GBP4,GBP5,GBP6,GBP7,GCH1,HLA-A,HLA-B,HLA-C,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,IFITM1,IFITM2,IFITM3,IL12RB1,IRF1,IRF7,JAK2,MEFV,MT2A,NLRC5,NMI,NUB1,OAS2,PARP14,PML,RAB20,SLC11A1,SOCS1,STAT1,TRIM22,TRIM31,UBD,VCAM1
GO:0045087 ACOD1,ADAM8,AIM2,APOBEC3A,APOBEC3D,APOBEC3G,APOL1,APPL2,B2M,C1QB,C1R,C1RL,C1S,C2,C3,C4A,C4B,CALCOCO2,CAMK2D,CASP4,CCL13,CCL15,CCL18,CCL5,CCL7,CCL8,CD300LF,CEACAM1,CFB,CFH,CIITA,CLEC10A,CLEC6A,COLEC12,CTSS,CX3CR1,CYLD,DDX60,DTX3L,EDN1,FCN1,GBP1,GBP2,GBP3,GBP4,GBP5,GBP6,GBP7,GCH1,GRAMD4,GSDMD,H2BC21,HLA-A,HLA-B,HLA-C,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,ICAM2,IFI27,IFI35,IFIH1,IFIT2,IFIT3,IFIT5,IFITM1,IFITM2,IFITM3,IL12A,IL12RB1,IL27,IRF1,IRF7,ISG20,JAK2,JAK3,KLRK1,LAG3,LILRA2,LYN,MCOLN2,MEFV,MSRB1,MT2A,MUC1,NCF1,NLRC5,NMI,NOD2,NUB1,OAS2,OPTN,PARP14,PML,PSMB10,PSMB8,PSMB9,PSME1,PSME2,PYHIN1,RAB20,RELB,RIPK2,RSAD2,SERINC5,SERPING1,SLAMF1,SLAMF6,SLAMF7,SLAMF8,SLC11A1,SOCS1,STAT1,STAT2,TICAM2,TIFA,TLR10,TLR5,TLR7,TLR8,TRAFD1,TRIM22,TRIM31,UBD,VCAM1,XAF1,ZBP1
GO:0071346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ACOD1,B2M,CAMK2D,CCL13,CCL15,CCL18,CCL5,CCL7,CCL8,CIITA,EDN1,GBP1,GBP2,GBP3,GBP4,GBP5,GBP6,GBP7,HLA-A,HLA-B,HLA-C,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,IL12RB1,IRF1,IRF7,JAK2,MT2A,NLRC5,NMI,OAS2,PARP14,PML,RAB20,SOCS1,STAT1,TRIM22,TRIM31,VCAM1
GO:0019221                                                                                                                                        ACSL1,AIM2,APPL2,B2M,BCL6,BIRC5,CAMK2D,CARD16,CASP4,CCL13,CCL15,CCL18,CCL5,CCL7,CCL8,CCRL2,CD300LF,CD40,CD74,CD80,CEACAM1,CIITA,CISH,CSF2RB,CX3CR1,CXCL10,CXCL11,CXCL5,CXCL9,CXCR3,CYLD,EDA,EDN1,FLT3LG,GBP1,GBP2,HGF,HLA-A,HLA-B,HLA-C,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,IFI27,IFI35,IFIT2,IFIT3,IFITM1,IFITM2,IFITM3,IL12A,IL12RB1,IL12RB2,IL15,IL15RA,IL18BP,IL1RN,IL22RA2,IL27,IL31RA,IL32,IL3RA,IRF1,IRF7,ISG20,JAK2,JAK3,KARS1,MMP9,MT2A,MUC1,NLRC5,NMI,NOD2,OAS2,OSM,PADI2,PARP14,PIM1,PML,PSMB10,PSMB8,PSMB9,PSME1,PSME2,RIPK2,RSAD2,S1PR1,SOCS1,STAP1,STAT1,STAT2,TICAM2,TNFRSF11A,TNFSF13B,TNFSF18,TNFSF8,TRIM22,TRIM31,VCAM1,XAF1,ZBP1
           gs_de_count gs_bg_count Expected gs_fuzzycluster gs_cluster_status
GO:0060333          34          82     4.55               1    Representative
GO:0060337          25          80     4.44               1            Member
GO:0034341          58         174     9.66               1            Member
GO:0045087         136         710    39.42               1            Member
GO:0071346          49         158     8.77               1            Member
GO:0019221         111         656    36.42               1            Member
> 
> # list only the representative clusters
> head(fuzzy_subset[fuzzy_subset$gs_cluster_status == "Representative", ], 10)
                gs_id
GO:0060333 GO:0060333
GO:0019885 GO:0019885
GO:0006958 GO:0006958
GO:0006270 GO:0006270
GO:0070098 GO:0070098
GO:0006954 GO:0006954
GO:0035455 GO:0035455
GO:0032727 GO:0032727
GO:0045124 GO:0045124
GO:0002250 GO:0002250
                                                                              gs_description
GO:0060333                                       interferon-gamma-mediated signaling pathway
GO:0019885 antigen processing and presentation of endogenous peptide antigen via MHC class I
GO:0006958                                          complement activation, classical pathway
GO:0006270                                                        DNA replication initiation
GO:0070098                                              chemokine-mediated signaling pathway
GO:0006954                                                             inflammatory response
GO:0035455                                                      response to interferon-alpha
GO:0032727                                positive regulation of interferon-alpha production
GO:0045124                                                     regulation of bone resorption
GO:0002250                                                          adaptive immune response
           gs_pvalue
GO:0060333  1.20e-20
GO:0019885  4.20e-12
GO:0006958  2.50e-07
GO:0006270  1.90e-08
GO:0070098  1.20e-06
GO:0006954  2.90e-08
GO:0035455  6.20e-05
GO:0032727  5.50e-04
GO:0045124  1.52e-03
GO:0002250  9.20e-23
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  gs_genes
GO:0060333                                                                                                                                                                                                                                                                                                                                                       B2M,CAMK2D,CIITA,GBP1,GBP2,HLA-A,HLA-B,HLA-C,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,IRF1,IRF7,JAK2,MT2A,NLRC5,NMI,OAS2,PARP14,PML,SOCS1,STAT1,TRIM22,TRIM31,VCAM1
GO:0019885                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   B2M,ERAP2,HLA-A,HLA-B,HLA-C,HLA-E,HLA-F,HLA-G,TAP1,TAP2,TAPBP
GO:0006958                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        C1QB,C1R,C1RL,C1S,C2,C3,C4A,C4B,SERPING1
GO:0006270                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           CCNE2,CDC45,CDC6,CDT1,MCM10,MCM2,MCM4,MCM5,MCM6,MCM7,ORC1,POLE2,TICRR
GO:0070098                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        CCL13,CCL15,CCL18,CCL5,CCL7,CCL8,CCRL2,CX3CR1,CXCL10,CXCL11,CXCL5,CXCL9,CXCR3,EDN1,PADI2
GO:0006954                                                                       ACOD1,ADAM8,ADGRE5,ADORA3,AGT,AIM2,AOC3,APOL2,APOL3,APPL2,BCL6,C1QB,C1R,C1S,C2,C3,C4A,C4B,CASP4,CCL13,CCL15,CCL18,CCL5,CCL7,CCL8,CCRL2,CD28,CD40,CDH5,CFB,CFH,CIITA,CR1L,CRHBP,CXCL10,CXCL11,CXCL5,CXCL9,CXCR3,CYLD,CYSLTR1,GBP5,GGT5,GHRL,GSDMD,HGF,HLA-E,ICAM1,IDO1,IL15,IL1RN,IL22RA2,IL27,JAK2,KARS1,KLF4,LRRK2,LY75,LYN,MEFV,MMP25,MMP9,NLRP12,NMI,NOD2,OSM,P2RX7,POLB,PTGER4,RELB,RIPK2,SBNO2,SERPING1,SLAMF8,SLC11A1,STAP1,SUCNR1,TGM2,TICAM2,TLR10,TLR5,TLR7,TLR8,TNFAIP6,TNFRSF11A,VCAM1,ZC3H12A
GO:0035455                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   IFIT2,IFIT3,IFITM1,IFITM2,IFITM3,LAMP3,PYHIN1
GO:0032727                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                IFIH1,IRF7,RIPK2,STAT1,TLR7,TLR8
GO:0045124                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ADAM8,CD38,P2RX7,PDK4,S1PR1,TMEM119,TNFRSF11A
GO:0002250 B2M,BCL6,BTN3A1,BTN3A2,BTN3A3,C1QB,C1R,C1RL,C1S,C2,C3,C4A,C4B,CD1A,CD1C,CD274,CD28,CD40,CD7,CD74,CD80,CEACAM1,CLEC10A,CLEC6A,CTLA4,CTSS,ERAP2,EXO1,FGL1,FGL2,GCNT3,GPR183,HLA-A,HLA-B,HLA-C,HLA-DMA,HLA-DMB,HLA-DOA,HLA-DOB,HLA-DPA1,HLA-DPB1,HLA-DQA1,HLA-DQB1,HLA-DQB2,HLA-DRA,HLA-DRB1,HLA-DRB5,HLA-E,HLA-F,HLA-G,ICAM1,IL12A,IL12RB1,IL18BP,IL27,IRF1,IRF7,ITK,JAK2,JAK3,KLRK1,LAG3,LAMP3,LILRA1,LILRB3,LYN,MCOLN2,P2RX7,PDCD1,PDCD1LG2,RELB,RIPK2,RNF19B,RSAD2,SERPING1,SIT1,SLAMF1,SLAMF6,SLAMF7,SLC11A1,TAP1,TAP2,TBX21,TLR8,TNFRSF11A,TNFRSF21,TNFSF13B,TNFSF18,ZC3H12A
           gs_de_count gs_bg_count Expected gs_fuzzycluster gs_cluster_status
GO:0060333          34          82     4.55               1    Representative
GO:0019885          11          14     0.78               2    Representative
GO:0006958           9          19     1.05               3    Representative
GO:0006270          13          35     1.94               4    Representative
GO:0070098          15          63     3.50               5    Representative
GO:0006954          87         589    32.70               6    Representative
GO:0035455           7          20     1.11               7    Representative
GO:0032727           6          20     1.11               8    Representative
GO:0045124           7          32     1.78               9    Representative
GO:0002250          89         323    17.93              10    Representative
> 
> 
> 
> cleanEx()
> nameEx("gs_heatmap")
> ### * gs_heatmap
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_heatmap
> ### Title: Plot a heatmap of the gene signature on the data
> ### Aliases: gs_heatmap
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> vst_macrophage <- vst(dds_macrophage)
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_heatmap(vst_macrophage,
+   res_de,
+   res_enrich,
+   anno_df,
+   geneset_id = res_enrich$gs_id[1],
+   cluster_columns = TRUE,
+   anno_col_info = "condition"
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_horizon")
> ### * gs_horizon
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_horizon
> ### Title: Plots a summary of enrichment results
> ### Aliases: gs_horizon
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> res_enrich2 <- res_enrich[1:42, ]
> res_enrich3 <- res_enrich[1:42, ]
> res_enrich4 <- res_enrich[1:42, ]
> 
> set.seed(2 * 42)
> shuffled_ones_2 <- sample(seq_len(42)) # to generate permuted p-values
> res_enrich2$gs_pvalue <- res_enrich2$gs_pvalue[shuffled_ones_2]
> res_enrich2$z_score <- res_enrich2$z_score[shuffled_ones_2]
> res_enrich2$aggr_score <- res_enrich2$aggr_score[shuffled_ones_2]
> 
> set.seed(3 * 42)
> shuffled_ones_3 <- sample(seq_len(42)) # to generate permuted p-values
> res_enrich3$gs_pvalue <- res_enrich3$gs_pvalue[shuffled_ones_3]
> res_enrich3$z_score <- res_enrich3$z_score[shuffled_ones_3]
> res_enrich3$aggr_score <- res_enrich3$aggr_score[shuffled_ones_3]
> 
> set.seed(4 * 42)
> shuffled_ones_4 <- sample(seq_len(42)) # to generate permuted p-values
> res_enrich4$gs_pvalue <- res_enrich4$gs_pvalue[shuffled_ones_4]
> res_enrich4$z_score <- res_enrich4$z_score[shuffled_ones_4]
> res_enrich4$aggr_score <- res_enrich4$aggr_score[shuffled_ones_4]
> 
> compa_list <- list(
+   scenario2 = res_enrich2,
+   scenario3 = res_enrich3,
+   scenario4 = res_enrich4
+ )
> 
> gs_horizon(res_enrich,
+   compared_res_enrich_list = compa_list,
+   n_gs = 50,
+   sort_by = "clustered"
+ )
> gs_horizon(res_enrich,
+   compared_res_enrich_list = compa_list,
+   n_gs = 20,
+   sort_by = "first_set"
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_mds")
> ### * gs_mds
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_mds
> ### Title: Multi Dimensional Scaling plot for gene sets
> ### Aliases: gs_mds
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_mds(res_enrich,
+   res_de,
+   anno_df,
+   n_gs = 200,
+   mds_labels = 10
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_radar")
> ### * gs_radar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_radar
> ### Title: Radar (spider) plot for gene sets
> ### Aliases: gs_radar gs_spider
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> gs_radar(res_enrich = res_enrich)
> # or using the alias...
> gs_spider(res_enrich = res_enrich)
> 
> # with more than one set
> res_enrich2 <- res_enrich[1:60, ]
> set.seed(42)
> shuffled_ones <- sample(seq_len(60)) # to generate permuted p-values
> res_enrich2$gs_pvalue <- res_enrich2$gs_pvalue[shuffled_ones]
> # ideally, I would also permute the z scores and aggregated scores
> gs_radar(
+   res_enrich = res_enrich,
+   res_enrich2 = res_enrich2
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_scores")
> ### * gs_scores
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_scores
> ### Title: Compute gene set scores
> ### Aliases: gs_scores
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> vst_macrophage <- vst(dds_macrophage)
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> scores_mat <- gs_scores(
+   vst_macrophage,
+   res_de,
+   res_enrich[1:50, ],
+   anno_df
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_scoresheat")
> ### * gs_scoresheat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_scoresheat
> ### Title: Plots a matrix of geneset scores
> ### Aliases: gs_scoresheat
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> vst_macrophage <- vst(dds_macrophage)
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> scores_mat <- gs_scores(
+   vst_macrophage,
+   res_de,
+   res_enrich[1:30, ],
+   anno_df
+ )
> gs_scoresheat(scores_mat,
+   n_gs = 30
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_simplify")
> ### * gs_simplify
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_simplify
> ### Title: Simplify results from functional enrichment analysis
> ### Aliases: gs_simplify
> 
> ### ** Examples
> 
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> 
> dim(res_enrich)
[1] 500   7
> res_enrich_simplified <- gs_simplify(res_enrich)
> dim(res_enrich_simplified)
[1] 143   7
> # and then use this further for all other functions expecting a res_enrich
> 
> 
> 
> cleanEx()
> nameEx("gs_summary_heat")
> ### * gs_summary_heat
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_summary_heat
> ### Title: Plots a heatmap for genes and genesets
> ### Aliases: gs_summary_heat
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_summary_heat(
+   res_enrich = res_enrich,
+   res_de = res_de,
+   annotation_obj = anno_df,
+   n_gs = 20
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_summary_overview")
> ### * gs_summary_overview
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_summary_overview
> ### Title: Plots a summary of enrichment results
> ### Aliases: gs_summary_overview
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_summary_overview(res_enrich)
> 
> # if desired, it can also be shown as a barplot
> gs_summary_overview(res_enrich, n_gs = 30, return_barchart = TRUE)
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_summary_overview_pair")
> ### * gs_summary_overview_pair
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_summary_overview_pair
> ### Title: Plots a summary of enrichment results
> ### Aliases: gs_summary_overview_pair
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> res_enrich2 <- res_enrich[1:42, ]
> set.seed(42)
> shuffled_ones <- sample(seq_len(42)) # to generate permuted p-values
> res_enrich2$gs_pvalue <- res_enrich2$gs_pvalue[shuffled_ones]
> res_enrich2$z_score <- res_enrich2$z_score[shuffled_ones]
> res_enrich2$aggr_score <- res_enrich2$aggr_score[shuffled_ones]
> # ideally, I would also permute the z scores and aggregated scores
> gs_summary_overview_pair(
+   res_enrich = res_enrich,
+   res_enrich2 = res_enrich2
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_upset")
> ### * gs_upset
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_upset
> ### Title: Upset plot for genesets
> ### Aliases: gs_upset
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> gs_upset(res_enrich,
+   n_gs = 10
+ )
> 
> gs_upset(res_enrich,
+   res_de = res_de, annotation_obj = anno_df,
+   n_gs = 8,
+   add_de_direction = TRUE, add_de_gsgenes = TRUE
+ )
> 
> # or using the practical gtl (GeneTonicList)
> gtl_macrophage <- GeneTonic_list(
+   dds = dds_macrophage,
+   res_de = res_de,
+   res_enrich = res_enrich,
+   annotation_obj = anno_df
+ )
---------------------------------
----- GeneTonicList object ------
---------------------------------

----- dds object -----
Providing an expression object (as DESeqDataset) of 58294 features over 24 samples

----- res_de object -----
Providing a DE result object (as DESeqResults), 17806 features tested, 928 found as DE
Upregulated:     599
Downregulated:   329

----- res_enrich object -----
Providing an enrichment result object, 500 reported

----- annotation_obj object -----
Providing an annotation object of 58294 features with information on 2 identifier types

> 
> gs_upset(
+   gtl = gtl_macrophage,
+   n_gs = 15,
+   add_de_direction = TRUE, add_de_gsgenes = TRUE
+ )
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("gs_volcano")
> ### * gs_volcano
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gs_volcano
> ### Title: Volcano plot for gene sets
> ### Aliases: gs_volcano
> 
> ### ** Examples
> 
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> gs_volcano(res_enrich)
Warning: Removed 16 rows containing missing values (`geom_point()`).
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("happy_hour")
> ### * happy_hour
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: happy_hour
> ### Title: Happy hour!
> ### Aliases: happy_hour
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> ## Not run: 
> ##D happy_hour(
> ##D   dds = dds_macrophage,
> ##D   res_de = res_de,
> ##D   res_enrich = res_enrich,
> ##D   annotation_obj = anno_df,
> ##D   project_id = "examplerun",
> ##D   mygroup = "condition",
> ##D   # mygroup = "line",   # alternatively
> ##D   mygenesets = res_enrich$gs_id[c(1:5, 11, 31)],
> ##D   mygenes = c(
> ##D     "ENSG00000125347",
> ##D     "ENSG00000172399",
> ##D     "ENSG00000137496"
> ##D   )
> ##D )
> ## End(Not run)
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("map2color")
> ### * map2color
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: map2color
> ### Title: Maps numeric values to color values
> ### Aliases: map2color
> 
> ### ** Examples
> 
> a <- 1:9
> pal <- RColorBrewer::brewer.pal(9, "Set1")
> map2color(a, pal)
[1] "#FFFF33" "#FFFF33" "#A65628" "#A65628" "#F781BF" "#F781BF" "#999999"
[8] "#999999" "#999999"
> plot(a, col = map2color(a, pal), pch = 20, cex = 4)
> 
> b <- 1:50
> pal2 <- grDevices::colorRampPalette(
+   RColorBrewer::brewer.pal(name = "RdYlBu", 11)
+ )(50)
> plot(b, col = map2color(b, pal2), pch = 20, cex = 3)
> 
> 
> 
> cleanEx()
> nameEx("overlap_coefficient")
> ### * overlap_coefficient
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: overlap_coefficient
> ### Title: Calculate overlap coefficient
> ### Aliases: overlap_coefficient
> 
> ### ** Examples
> 
> a <- seq(1, 21, 2)
> b <- seq(1, 11, 2)
> overlap_coefficient(a, b)
[1] 1
> 
> 
> 
> cleanEx()
> nameEx("overlap_jaccard_index")
> ### * overlap_jaccard_index
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: overlap_jaccard_index
> ### Title: Calculate Jaccard Index between two sets
> ### Aliases: overlap_jaccard_index
> 
> ### ** Examples
> 
> a <- seq(1, 21, 2)
> b <- seq(1, 11, 2)
> overlap_jaccard_index(a, b)
[1] 0.5454545
> 
> 
> 
> cleanEx()
> nameEx("shake_davidResult")
> ### * shake_davidResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_davidResult
> ### Title: Convert the output of DAVID
> ### Aliases: shake_davidResult
> 
> ### ** Examples
> 
> david_output_file <- system.file("extdata",
+   "david_output_chart_BPonly_ifng_vs_naive.txt",
+   package = "GeneTonic"
+ )
> res_enrich <- shake_davidResult(david_output_file)
Found 237 gene sets in the file output from DAVID of which 170 are significant (p-value <= 0.05).
Converting for usage in GeneTonic...
> 
> 
> 
> cleanEx()
> nameEx("shake_enrichResult")
> ### * shake_enrichResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_enrichResult
> ### Title: Convert an enrichResult object
> ### Aliases: shake_enrichResult
> 
> ### ** Examples
> 
> # dds
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> data(gse)
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> de_symbols_IFNg_vs_naive <- res_macrophage_IFNg_vs_naive[
+   (!(is.na(res_macrophage_IFNg_vs_naive$padj))) &
+     (res_macrophage_IFNg_vs_naive$padj <= 0.05), "SYMBOL"
+ ]
> bg_ids <- rowData(dds_macrophage)$SYMBOL[rowSums(counts(dds_macrophage)) > 0]
> ## Not run: 
> ##D library("clusterProfiler")
> ##D library("org.Hs.eg.db")
> ##D ego_IFNg_vs_naive <- enrichGO(
> ##D   gene = de_symbols_IFNg_vs_naive,
> ##D   universe = bg_ids,
> ##D   keyType = "SYMBOL",
> ##D   OrgDb = org.Hs.eg.db,
> ##D   ont = "BP",
> ##D   pAdjustMethod = "BH",
> ##D   pvalueCutoff = 0.01,
> ##D   qvalueCutoff = 0.05,
> ##D   readable = FALSE
> ##D )
> ##D 
> ##D res_enrich <- shake_enrichResult(ego_IFNg_vs_naive)
> ##D head(res_enrich)
> ## End(Not run)
> 
> 
> 
> cleanEx()

detaching ‘package:DESeq2’, ‘package:SummarizedExperiment’,
  ‘package:Biobase’, ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("shake_enrichrResult")
> ### * shake_enrichrResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_enrichrResult
> ### Title: Convert the output of Enrichr
> ### Aliases: shake_enrichrResult
> 
> ### ** Examples
> 
> # library("enrichR")
> # dbs <- c("GO_Molecular_Function_2018",
> #          "GO_Cellular_Component_2018",
> #          "GO_Biological_Process_2018",
> #          "KEGG_2019_Human",
> #          "Reactome_2016",
> #          "WikiPathways_2019_Human")
> # degenes <- (deseqresult2df(res_macrophage_IFNg_vs_naive, FDR = 0.01)$SYMBOL)
> # if called directly within R...
> # enrichr_output_macrophage <- enrichr(degenes, dbs)
> # or alternatively, if downloaded from the website in tabular format
> enrichr_output_file <- system.file("extdata",
+   "enrichr_tblexport_IFNg_vs_naive.txt",
+   package = "GeneTonic"
+ )
> res_from_enrichr <- shake_enrichrResult(enrichr_output_file = enrichr_output_file)
Found 2734 gene sets in the file output from Enrichr of which 514 are significant (p-value <= 0.05).
Converting for usage in GeneTonic...
> # res_from_enrichr2 <- shake_enrichrResult(
> #   enrichr_output = enrichr_output_macrophage[["GO_Biological_Process_2018"]])
> 
> 
> 
> cleanEx()
> nameEx("shake_fgseaResult")
> ### * shake_fgseaResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_fgseaResult
> ### Title: Convert the output of fgsea
> ### Aliases: shake_fgseaResult
> 
> ### ** Examples
> 
> data(fgseaRes, package = "GeneTonic")
> res_from_fgsea <- shake_fgseaResult(fgseaRes)
Found 7341 gene sets in the file output from Enrichr of which 102 are significant (p-value <= 0.05).
Converting for usage in GeneTonic...
Using the content of the 'leadingEdge' column to generate the 'gs_genes' for GeneTonic... If you have that information available directly, please adjust the content accordingly.

Using the set of the leadingEdge size to compute the 'gs_de_count'


fgsea is commonly returning no identifier for the gene sets used. Please consider editing the 'gs_id' field manually according to the gene set you provided
> 
> 
> 
> cleanEx()
> nameEx("shake_gprofilerResult")
> ### * shake_gprofilerResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_gprofilerResult
> ### Title: Convert the output of g:Profiler
> ### Aliases: shake_gprofilerResult
> 
> ### ** Examples
> 
> # degenes <- (deseqresult2df(res_macrophage_IFNg_vs_naive, FDR = 0.01)$SYMBOL)
> # if called directly withín R...
> # enrichr_output_macrophage <- enrichr(degenes, dbs)
> # or alternatively, if downloaded from the website in tabular format
> gprofiler_output_file <- system.file(
+   "extdata",
+   "gProfiler_hsapiens_5-25-2020_tblexport_IFNg_vs_naive.csv",
+   package = "GeneTonic"
+ )
> res_from_gprofiler <- shake_gprofilerResult(gprofiler_output_file = gprofiler_output_file)
Found 5593 gene sets in the file output from Enrichr of which 179 are significant (p-value <= 0.05).
Converting for usage in GeneTonic...
> 
> data(gostres_macrophage, package = "GeneTonic")
> res_from_gprofiler_2 <- shake_gprofilerResult(
+   gprofiler_output = gostres_macrophage$result
+ )
Found 5593 gene sets in the file output from Enrichr of which 179 are significant (p-value <= 0.05).
Converting for usage in GeneTonic...
> 
> 
> 
> cleanEx()
> nameEx("shake_gsenrichResult")
> ### * shake_gsenrichResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_gsenrichResult
> ### Title: Convert a gseaResult object
> ### Aliases: shake_gsenrichResult
> 
> ### ** Examples
> 
> # dds
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> data(gse)
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> sorted_genes <- sort(
+   setNames(res_macrophage_IFNg_vs_naive$log2FoldChange, 
+            res_macrophage_IFNg_vs_naive$SYMBOL), 
+   decreasing = TRUE
+ )
> ## Not run: 
> ##D library("clusterProfiler")
> ##D library("org.Hs.eg.db")
> ##D gsego_IFNg_vs_naive <- gseGO(
> ##D   geneList = sorted_genes,
> ##D   ont = "BP",
> ##D   OrgDb = org.Hs.eg.db,
> ##D   keyType = "SYMBOL",
> ##D   minGSSize = 10,
> ##D   maxGSSize = 500,
> ##D   pvalueCutoff = 0.05,
> ##D   verbose = TRUE
> ##D )
> ##D 
> ##D res_enrich <- shake_gsenrichResult(gsego_IFNg_vs_naive)
> ##D head(res_enrich)
> ##D gtl_macrophage <- GeneTonicList(
> ##D   dds = dds_macrophage,
> ##D   res_de = res_macrophage_IFNg_vs_naive,
> ##D   res_enrich = res_enrich,
> ##D   annotation_obj = anno_df
> ##D )
> ## End(Not run)
> 
> 
> 
> cleanEx()

detaching ‘package:DESeq2’, ‘package:SummarizedExperiment’,
  ‘package:Biobase’, ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("shake_topGOtableResult")
> ### * shake_topGOtableResult
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shake_topGOtableResult
> ### Title: Convert a topGOtableResult object
> ### Aliases: shake_topGOtableResult
> 
> ### ** Examples
> 
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> 
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> 
> 
> 
> cleanEx()
> nameEx("signature_volcano")
> ### * signature_volcano
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: signature_volcano
> ### Title: Plot a volcano plot of a geneset
> ### Aliases: signature_volcano
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> signature_volcano(res_de,
+   res_enrich,
+   anno_df,
+   geneset_id = res_enrich$gs_id[1]
+ )
Warning: ggrepel: 42 unlabeled data points (too many overlaps). Consider increasing max.overlaps
> 
> # alternatively
> 
> chemokine_list <- c(
+   "ENSG00000108702",
+   "ENSG00000172156",
+   "ENSG00000181374",
+   "ENSG00000276409"
+ )
> 
> signature_volcano(res_de,
+   res_enrich,
+   anno_df,
+   genelist = chemokine_list
+ )
Warning in signature_volcano(res_de, res_enrich, anno_df, genelist = chemokine_list) :
  Some of the provided gene ids were not found in the SummarizedExperiment
Not found: ENSG00000172156
> 
> 
> 
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> nameEx("styleColorBar_divergent")
> ### * styleColorBar_divergent
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: styleColorBar_divergent
> ### Title: Style DT color bars
> ### Aliases: styleColorBar_divergent
> 
> ### ** Examples
> 
> 
> data(res_de_macrophage, package = "GeneTonic")
> res_df <- deseqresult2df(res_macrophage_IFNg_vs_naive)
> library("magrittr")
> library("DT")
> DT::datatable(res_df[1:50, ],
+   options = list(
+     pageLength = 25,
+     columnDefs = list(
+       list(className = "dt-center", targets = "_all")
+     )
+   )
+ ) %>%
+   formatRound(columns = c("log2FoldChange"), digits = 3) %>%
+   formatStyle(
+     "log2FoldChange",
+     background = styleColorBar_divergent(
+       res_df$log2FoldChange,
+       scales::alpha("navyblue", 0.4),
+       scales::alpha("darkred", 0.4)
+     ),
+     backgroundSize = "100% 90%",
+     backgroundRepeat = "no-repeat",
+     backgroundPosition = "center"
+   )
> 
> 
> simplest_df <- data.frame(
+   a = c(rep("a", 9)),
+   value = c(-4, -3, -2, -1, 0, 1, 2, 3, 4)
+ )
> 
> # or with a very simple data frame
> DT::datatable(simplest_df) %>%
+   formatStyle(
+     "value",
+     background = styleColorBar_divergent(
+       simplest_df$value,
+       scales::alpha("forestgreen", 0.4),
+       scales::alpha("gold", 0.4)
+     ),
+     backgroundSize = "100% 90%",
+     backgroundRepeat = "no-repeat",
+     backgroundPosition = "center"
+   )
> 
> 
> 
> cleanEx()

detaching ‘package:DT’, ‘package:magrittr’

> nameEx("summarize_ggs_hubgenes")
> ### * summarize_ggs_hubgenes
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: summarize_ggs_hubgenes
> ### Title: Summarize information on the hub genes
> ### Aliases: summarize_ggs_hubgenes
> 
> ### ** Examples
> 
> library("macrophage")
> library("DESeq2")
Loading required package: S4Vectors
Warning: package ‘S4Vectors’ was built under R version 4.3.2
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following object is masked from ‘package:utils’:

    findMatches

The following objects are masked from ‘package:base’:

    I, expand.grid, unname

Loading required package: IRanges
Loading required package: GenomicRanges
Loading required package: GenomeInfoDb
Warning: package ‘GenomeInfoDb’ was built under R version 4.3.2
Loading required package: SummarizedExperiment
Warning: package ‘SummarizedExperiment’ was built under R version 4.3.2
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

> library("org.Hs.eg.db")
Loading required package: AnnotationDbi
> library("AnnotationDbi")
> 
> # dds object
> data("gse", package = "macrophage")
> dds_macrophage <- DESeqDataSet(gse, design = ~ line + condition)
using counts and average transcript lengths from tximeta
> rownames(dds_macrophage) <- substr(rownames(dds_macrophage), 1, 15)
> dds_macrophage <- estimateSizeFactors(dds_macrophage)
using 'avgTxLength' from assays(dds), correcting for library size
> 
> # annotation object
> anno_df <- data.frame(
+   gene_id = rownames(dds_macrophage),
+   gene_name = mapIds(org.Hs.eg.db,
+     keys = rownames(dds_macrophage),
+     column = "SYMBOL",
+     keytype = "ENSEMBL"
+   ),
+   stringsAsFactors = FALSE,
+   row.names = rownames(dds_macrophage)
+ )
'select()' returned 1:many mapping between keys and columns
> 
> # res object
> data(res_de_macrophage, package = "GeneTonic")
> res_de <- res_macrophage_IFNg_vs_naive
> 
> # res_enrich object
> data(res_enrich_macrophage, package = "GeneTonic")
> res_enrich <- shake_topGOtableResult(topgoDE_macrophage_IFNg_vs_naive)
Found 500 gene sets in `topGOtableResult` object.
Converting for usage in GeneTonic...
> res_enrich <- get_aggrscores(res_enrich, res_de, anno_df)
> 
> ggs <- ggs_graph(
+   res_enrich,
+   res_de,
+   anno_df
+ )
> dt_df <- summarize_ggs_hubgenes(ggs)
> DT::datatable(dt_df, escape = FALSE)
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()

detaching ‘package:org.Hs.eg.db’, ‘package:AnnotationDbi’,
  ‘package:DESeq2’, ‘package:SummarizedExperiment’, ‘package:Biobase’,
  ‘package:MatrixGenerics’, ‘package:matrixStats’,
  ‘package:GenomicRanges’, ‘package:GenomeInfoDb’, ‘package:IRanges’,
  ‘package:S4Vectors’, ‘package:BiocGenerics’, ‘package:stats4’,
  ‘package:macrophage’

> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  74.959 3.631 80.303 0 0 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
